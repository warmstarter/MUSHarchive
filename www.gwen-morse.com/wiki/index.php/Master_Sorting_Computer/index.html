<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" /><title>Master Sorting Computer - Gwen Morse's Wiki</title>
<meta name="generator" content="MediaWiki 1.22.8" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/wiki/opensearch_desc.php" title="Gwen Morse's Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://www.gwen-morse.com/wiki/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Gwen Morse's Wiki Atom feed" href="/wiki/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="http://www.gwen-morse.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cskins.vector&amp;only=styles&amp;skin=vector&amp;*" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(ckb),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: homesitewiki-mw_:resourceloader:filter:minify-css:7:caed6998fab899483c805c3e2c432ff5 */</style>

<script src="http://www.gwen-morse.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Master_Sorting_Computer","wgTitle":"Master Sorting Computer","wgCurRevisionId":2512,"wgRevisionId":2512,"wgArticleId":645,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Master_Sorting_Computer","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"vector-simplesearch":1,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,
"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"useeditwarning":1,"prefershttps":1,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: homesitewiki-mw_:resourceloader:filter:minify-js:7:5a69c7e0fa6557851b6dea8a62efaffb */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/wiki/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Master_Sorting_Computer skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Master Sorting Computer</span></h1>
			<div id="bodyContent">
								<div id="siteSub">From Gwen Morse&#039;s Wiki</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-navigation">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><pre>
@create Master Sorting Computer=10
@lock Master Sorting Computer=*Gwen
&amp;SORTER_LOCK Master Sorting Computer=#2749
@Ufail Master Sorting Computer=Permission denied.
&amp;CRYSTAL--1 Master Sorting Computer=None
&amp;SCALE Master Sorting Computer=do re mi fa so la ti dx
&amp;OUTPUT Master Sorting Computer=secure([ljust(extract(%0, 3, 1), 8)][ljust(extract(%0, 10, 1), 13)][ljust(extract(%0, 6, 1), 10)][ljust(extract(%0, 5, 1), 7)][mid(extract(%0, 4, 1), 0, 7)][space(1)][ljust(extract(%0, 9, 1), 16)]-- [extract(%0, 12, 1)])
&amp;SET-FMT Master Sorting Computer=switch(%0,none,%b( unassigned:%b%bmust be [secure(extract(v(scalenotes), member(v(scale),&#160;%1) ,1))] or [secure(v([extract(v(scalenotes), member(v(scale),&#160;%1) ,1)]_alt))]%b),&#160;%b[u(setoutput,&#160;%0)])
&amp;SETSCALE Master Sorting Computer=$set scale *:@swi elock(v(sorter_lock),&#160;%#)=1,{@wait me = {&amp;debug_table me = set scale&#160;%0; @switch/first 0=&lt;[member(v(valid-scales), u(tweakscale,&#160;%0))],{@tr me/setscale2 = u(tweakscale,&#160;%0)},&lt;[member(v(valid-scales), [lcstr(edit(%0,%b,$))]-major)],{@tr me/setscale2 = [lcstr(edit(%0,&#160;%b, $))]-major},{@pemit&#160;%#='%0' is not a valid scale.; @notify me}}},{@pemit&#160;%#=Permission denied.}
&amp;CARTON_LOCK Master Sorting Computer=#585
&amp;UNPACK Master Sorting Computer=$unpack *: @swi elock(v(sorter_lock),&#160;%#)=1, {@wait me= {&amp;debug_table me = unpack&#160;%0; @swi/first [setq(0, locate(me,%0,n))]1 = strmatch(%q0, #-1), {@pemit&#160;%# = Bad carton name '%0'.; @notify me}, strmatch(%q0, #-2), {@pemit&#160;%#= Which carton?; @notify me}, elock(v(tuner_carton_lock),&#160;%q0), {@pemit&#160;%# = That object is a special tuner carton and may not be unpacked on this table.; @no me}, not(elock(v(carton_lock),&#160;%q0)), {@pemit&#160;%# = That object is not registered as a crystal carton. If you think it should be, please contact a wizard.; @notify me}, strmatch(get(%q0/unpack_in_progress), true),{@pemit&#160;%# = An unpack is already in progress for the specified carton.; @notify me}, gt(add(get(%q0/num),words(v(crystal-list))),75), {@pemit&#160;%#=That many crystals would exceed the table's capacity. There is room for [sub(75,words(v(crystal-list)))] crystals currently.; @notify me}, {empty carton&#160;%q0;@emit&#160;%N opens [name(%q0)] and looks inside.; &amp;unpack_in_progress&#160;%q0 = true; @tr me/do-unpack =&#160;%q0,&#160;%N,&#160;%S}}}, {@pemit&#160;%#=Permission denied.}
&amp;DO-UNPACK Master Sorting Computer=@switch/first 0 = strmatch(loc(%0), loc(me)), {@pemit&#160;%1 = That carton is not currently in the same room as the table.; &amp;unpack_in_progress&#160;%0 = false; @notify me}, get(%0/num), {@emit&#160;%1 searches for crystals in [name(%0)], but finds it empty.; &amp;unpack_in_progress&#160;%0 = false; @notify me}, not(and(words(v(crystal-list)), comp(extract(v(crystal-[first(v(crystal-list))]), 1, 1), extract(get(%0/crystal-1), 1, 1)))), {@emit Currently sorting crystals for [name(extract(v(crystal-[first(v(crystal-list))]), 1, 1))]. That carton belongs to [name(extract(get(%0/crystal-1), 1, 1))].; &amp;unpack_in_progress&#160;%0 = false; @notify me}, {@dolist lnum(get(%0/num)) = {&amp;crystal-[add(first(revwords(v(crystal-list))), 1)] me = [get(%0/crystal-[add(1, ##)])] 0; &amp;crystal-list me = [v(crystal-list)] [add(first(revwords(v(crystal-list))), 1)]}; @swi [setq(7,convtime(get(%0/date_packed)))]1 = 1, {@emit&#160;%1 carefully lifts [u(unpack-num, get(%0/num),&#160;%2)] reverently on the sorting table.; @trigger v(master_sled)/deactivate_carton =&#160;%0, get(%0/sled); &amp;sorter me =&#160;%1;&amp;sorter_orig me = default(%0/sorter,%1);@switch and(lt([sub(secs(),%q7)],1209600),comp([v(sorter)],[v(sorter_orig)]),not(match([get(#5954/friendly_sorters_list)],[v(sorter_orig)])))=0,@@ same person,&amp;clash_[secs()] #5954=%1 unpacked [v(sorter_orig)]'s carton. (%q7); @trigger me/empty_carton =&#160;%0; &amp;tuner me=get(%0/tuner); @notify me}}
&amp;MASTER_SLED Master Sorting Computer=#384
&amp;UNPACK-NUM Master Sorting Computer=switch(%0, 1, the single crystal it contains.&#160;%1 places it, each of the&#160;%0 crystals out.&#160;%1 arranges them)
&amp;LIST-ALL Master Sorting Computer=$list all: @pemit&#160;%#=[setq(0, v(crystal-list))][switch(words(%q0), 0, There are no crystals on the table currently., {Crystals on table:%r%rNum Note%b%b%b%bSize[space(9)]Shade[space(5)]Color%b%bShape[space(3)]Clarity%r--- ------- ------------ --------- ------ ------- ---------------[iter(lnum(words(%q0)),{%r[rjust(add(##, 1), 3)]%b[u(output, v(crystal-[extract(%q0, add(##, 1), 1)]))]})]%r%rThese crystals were cut from a vein with a basic scale of [setq(1, secure(extract(v(crystal-[first(v(crystal-list))]), 11, 1)))]&#160;%q1, use a 'set scale&#160;%q1 minor' or 'set scale&#160;%q1 major' when evaluating this set of crystals.})]
&amp;LIST-SET Master Sorting Computer=$list group:@pemit&#160;%#=Crystals in current grouping, scale is [edit(secure(v(currentscale)), -,&#160;%b)]:%r%r%b[iter(v(scale), ##: [u(set-fmt, v(crystal-[v(set-##)]), ##)]%r)]
&amp;SELECT Master Sorting Computer=$select *=*:@swi elock(v(sorter_lock),&#160;%#)=1,{@wait me={&amp;debug_table me = select&#160;%0=%1; @switch/first 0 = and(eq(words(%0), 1), member(v(scale), lcstr(%0))),{@pemit&#160;%# = '%0' is not a valid note. Try one of:%b%b[v(scale)].; @notify me},and(gt(%1, 0), lte(%1, words(v(crystal-list)))),{@pemit&#160;%# = [add(%1, 0)] is not a valid crystal number. Try a number between 1 and [words(v(crystal-list))].; @notify me},or(strmatch(extract(v(scalenotes), member(v(scale),&#160;%0), 1),extract(v(crystal-[extract(v(crystal-list),&#160;%1, 1)]), 3, 1) ),strmatch(v([extract(v(scalenotes), member(v(scale),&#160;%0), 1)]_alt),extract(v(crystal-[extract(v(crystal-list),&#160;%1, 1)]), 3, 1) )),{@pemit&#160;%# = Note '%0' of [edit(secure(v(currentscale)), -,&#160;%b)] requires a crystal tuned to [secure(extract(v(scalenotes), member(v(scale),&#160;%0), 1))] or [secure(v([extract(v(scalenotes), member(v(scale),&#160;%0), 1)]_alt))].; @notify me},extract(v(crystal-[extract(v(crystal-list),&#160;%1, 1)]), 12, 1),{@switch v(set-%0) = -1,,{&amp;crystal-[v(set-%0)] me = [extract(v(crystal-[v(set-%0)]), 1, 11)] 0;@emit&#160;%N removes crystal [member(v(crystal-list), v(set-%0))] which is currently slated for note '%0' and replaces it with another.;};@tr me/do-select =&#160;%0, extract(v(crystal-list),&#160;%1, 1), add(%1, 0)},{@pemit&#160;%#=Crystal '[add(%1, 0)]' has already been assigned to '[extract(v(crystal-[extract(v(crystal-list),&#160;%1, 1)]), 12, 1)]'.; @notify me}}},{@pemit&#160;%#=Permission denied.}
&amp;DO-SELECT Master Sorting Computer=&amp;currentvalue me = 0; &amp;crystal-%1 me = [extract(v(crystal-%1), 1, 11)]&#160;%0; &amp;set-%0 me =&#160;%1; @emit Crystal&#160;%2 assigned to note '%0'.; @notify me
&amp;UNSELECT Master Sorting Computer=$unselect *:@swi elock(v(sorter_lock),&#160;%#)=1,{@wait me = {&amp;debug_table me = unselect&#160;%0; @switch/first 0 = and(eq(words(%0), 1), member(v(scale), lcstr(%0))),{@pemit&#160;%# = '%0' is not a valid note. Try one of:%b%b[v(scale)].; @notify me},neq(v(set-%0), -1),{@pemit&#160;%# = Note '%0' is already empty.; @notify me},{&amp;currentvalue me = 0; &amp;crystal-[v(set-%0)] me = [extract(v(crystal-[v(set-%0)]), 1, 11)] 0; &amp;set-%0 me = -1; @emit Crystal removed from note&#160;%0.; @notify me}}},{@pemit&#160;%#=Permission denied.}
&amp;STARTOVER Master Sorting Computer=$start over: @swi elock(v(sorter_lock),&#160;%#)=1, {@wait me = {&amp;debug_table me = start over; @emit Clearing groups...; &amp;sets me = 0; &amp;currentvalue me = 0; &amp;totalvalue me = 0; @dolist v(scale) = &amp;set-## me=-1; @dolist v(crystal-list) = &amp;crystal-## me = [extract(v(crystal-##), 1, 11)] 0; @swi 1 = 1, {@emit All group records cleared. You may start reassigning the crystals on the table into a group.; @notify me}}}, {@pemit&#160;%#=Permission denied.}
&amp;COMMIT Master Sorting Computer=$commit:@swi elock(v(sorter_lock),&#160;%#)=1,{@wait me = {&amp;debug_#2755 me = commit; @switch/first 0 = v(currentvalue),{@pemit&#160;%# = You must 'evaluate' the set first.; @notify me},words(u(ex-set, 1)),{@pemit&#160;%#=You can't commit an empty group.; @notify me},{&amp;sets me = add(v(sets), 1);&amp;string-[v(sets)] me=u(one-set,[extract(v(setstrings),member(v(rg-setpattern), u(setpattern)), 1)],[extract(v(rg-shape),member(v(rg-shape), first(u(ex-set, 4))),1)],[extract(v(rg-color),member(v(rg-color), first(u(ex-set, 5))),1)],[extract(v(rg-shade),member(v(rg-shade), first(u(ex-set, 6))),1)],[u(set-worst-string,9,v(rg-clarity),v(rg-clarity-short))],[u(set-worst-string,10,v(rg-size),v(rg-size))]);@dolist v(scale) = {&amp;crystal-[v(set-##)] me = switch(v(set-##), -1, None, [extract(v(crystal-[v(set-##)]), 1, 11)] [v(sets)]/##);&amp;set-## me = -1};@swi 1 = 1, {&amp;totalvalue me = add(v(totalvalue), v(currentvalue)); &amp;set_[v(sets)]_value me = v(currentvalue); &amp;currentvalue me = 0; @emit&#160;%N labels this group of crystals and sets it aside. Total value now:%b%b[v(totalvalue)].; @swi [setq(0,rand(u(injchance)))][gte(%q0,v(injuries))]+[strmatch(get(%#/medical_state),*[u(injury-%q0)]*)]=0+0,{@trigger v(medical_control)/append_medical_state = num(me),&#160;%#, [u(injury-%q0)],[switch(member(v(major_injs),%q0),0,,INACTIVE)];@pemit&#160;%#=%r[udefault(injmess-%q0,[u(injmess)])];@pemit/contents [where(me)]=%r[udefault(oxinjmess-%q0,[u(oxinjmess)])];@oemit&#160;%#=%r[udefault(oinjmess-%q0,[u(oinjmess)])]},{@pemit&#160;%#=[u(lucky)]};@notify me}}}},{@pemit&#160;%# = Permission denied.}
&amp;EX-NOTE Master Sorting Computer=switch(v(set-%0), -1,, extract(v(crystal-[v(set-%0)]),&#160;%1, 1))
&amp;EX-SET Master Sorting Computer=trim(iter(v(scale), u(ex-note, ##,&#160;%0)))
&amp;LIST-EQ Master Sorting Computer=switch(words(%0), 0, #-1, 1, 1, 2,not(comp(first(%0), first(rest(%0)))), and(not(comp(first(%0), first(rest(%0)))), u(list-eq, rest(%0))))
&amp;SET-EQ Master Sorting Computer=u(list-eq, u(ex-set,&#160;%0))
&amp;LIST-WORST Master Sorting Computer=switch(words(%0), 0,#-1, 1,extract(%2, member(%1,&#160;%0), 1),min(extract(%2, member(%1, first(%0)), 1), u(list-worst, rest(%0),&#160;%1,&#160;%2)))
&amp;SET-WORST Master Sorting Computer=u(list-worst, u(ex-set,&#160;%0),&#160;%1,&#160;%2)
&amp;FACTOR-FIRST Master Sorting Computer=extract(v(vl-%1), member(v(rg-%1), first(u(ex-set,&#160;%0))), 1)
&amp;FACTOR-WORST Master Sorting Computer=u(set-worst,&#160;%0, v(rg-%1), v(vl-%1))
&amp;SETPATTERN Master Sorting Computer=[switch(v(set-do), -1, ., X)][switch(v(set-re), -1, ., X)][switch(v(set-mi), -1, ., X)][switch(v(set-fa), -1, ., X)][switch(v(set-so), -1, ., X)][switch(v(set-la), -1, ., X)][switch(v(set-ti), -1, ., X)][switch(v(set-dx), -1, ., X)]
&amp;RG-SHAPE Master Sorting Computer=pyramid rectangle pentagon octagon dodecahedron cylinder prism cone
&amp;RG-COLOR Master Sorting Computer=rose green blue yellow white black amethyst
&amp;RG-SHADE Master Sorting Computer=very$pale pale light medium deep rich$deep pure
&amp;RG-CLARITY Master Sorting Computer=majorly$flawed flawed slightly$flawed very$slightly$flawed perfect
&amp;RG-SIZE Master Sorting Computer=tiny very$small small medium$small medium medium$large large very$large
&amp;EVALUATE Master Sorting Computer=$evaluate:@swi elock(v(sorter_lock),&#160;%#)=1,{@emit A pleasant voice from the computer says &quot;Evaluating, please wait...&quot;; @wait me = {&amp;debug_table me = evaluate; @switch 0 = words(u(ex-set, 1)),{@emit A light on the computer flashes red, and a pleasant voice says &quot;Current group has no crystals.&quot;; @notify me},u(set-eq, 4),{@tr me/neqmsg = shape},u(set-eq, 5),{@tr me/neqmsg = color},u(set-eq, 6),{@tr me/neqmsg = shade},member(v(rg-setpattern), u(setpattern)),{@emit Several lights on the computer flash red. A pleasant voice says &quot;The current group does not match any marketable pattern. Please remove or rearrange crystals.; @notify me},{@tr me/do-value = extract(v(vl-setpattern), member(v(rg-setpattern), u(setpattern)), 1),u(factor-first, 4, shape),u(factor-first, 5, color),u(factor-first, 6, shade),u(factor-worst, 9, clarity),u(factor-worst, 10, size),v(demand),&#160;%#}}},{@pemit&#160;%#=Permission denied.}
&amp;DO-VALUE Master Sorting Computer=&amp;currentvalue me = u(total,&#160;%0,&#160;%1,&#160;%2,&#160;%3,&#160;%4,&#160;%5,&#160;%6);@emit The display on the computer lights up, showing the value [v(currentvalue)].; @pemit&#160;%7 = Debug Values:%b%bPattern:&#160;%0, Shape:&#160;%1, Color:&#160;%2, Shade:&#160;%3, Clarity:&#160;%4, Size:&#160;%5, Demand:&#160;%6; @notify me
&amp;NEQMSG Master Sorting Computer=@emit Several lights on the computer flash red. A pleasant voice says &quot;All crystals in the group must be the same&#160;%0. Please remove unmatched crystals.&quot;; @notify me
&amp;TOTAL Master Sorting Computer=max(round(fdiv(mul(fdiv(mul(%0,&#160;%1,&#160;%2,&#160;%3), 1000),&#160;%4,&#160;%5,&#160;%6), 1000),0),1)
&amp;SELL Master Sorting Computer=$sell:@swi elock(v(sorter_lock),&#160;%#)=1,{@switch words(v(crystal-list)) = 0,{@pemit&#160;%#=Nothing here to sell.},{@wait me = {&amp;debug_table me = sell; @emit The voice from the computer says &quot;One moment please...&quot;; @va me = 0; @vb me = 0; @dolist v(crystal-list) = {@vb me = add(%vb, switch(strmatch(extract(v(crystal-##), 12, 1), */*),1, 0, 1));@swi ## = first(revwords(v(crystal-list))),{@switch/first&#160;%va+%vb = 0+0,{@tr me/sell2 =&#160;%#},0+*,{@emit The computer says &quot;Transaction incomplete --&#160;%vb crystal(s) have not been committed yet.&quot;; @notify me},*+0,{@emit The computer says &quot;Transaction incomplete --&#160;%va crystal(s) have not been evaluated yet.&quot;; @notify me},{@emit The computer says &quot;Transaction incomplete --&#160;%va crystal(s) have not been evaluated yet and&#160;%vb crystal(s) have not been committed yet.&quot;; @notify me}}}}}},{@pemit&#160;%#=Permission denied.}
&amp;SELL2 Master Sorting Computer=@wait v(crystal_db) ={@vb me = secs(); @vc me = get(v(crystal_db)/num); @emit Total value of crystals is:%b%b[v(totalvalue)]. Taking into consideration the 30%% Guild tithe, [div(mul(v(totalvalue), 70), 100)] will be credited to [name(extract(v(crystal-[first(v(crystal-list))]), 1, 1))]'s account.; @tr #800/pay_singer_for_crystal=extract(v(crystal-[first(v(crystal-list))]), 1, 1),div(mul(v(totalvalue), 70), 100),%vb, words(v(crystal-list)),%0, div(v(totalvalue), 10);@dolist v(crystal-list) = {&amp;crystal-[add(%vc, member(v(crystal-list), ##))] [v(crystal_db)] = [v(crystal-##)]&#160;%vb; &amp;crystal-## me =&#160;;};@fo me={&amp;num [v(crystal_db)] = add(%vc, words(v(crystal-list))); @notify [v(crystal_db)]; @dolist v(scale) = &amp;set-## me = -1; &amp;crystal-list me =&#160;; &amp;sets me = 0; &amp;currentvalue me = 0; &amp;totalvalue me = 0; @fo me = {@trigger me/trap_problem = sell; @notify me; @emit The crystal is quickly packed and removed by Heptite Guild workers, as the computer voice says &quot;Transaction complete. Sorting computer reset.&quot;; @swi [setq(0,filter(here_with_gloves,v(wearing_gloves)))][not(words(%q0))]=0,{@pemit/list&#160;%q0=You strip off your protective gloves and put them in the disposal.; @pemit/list [filter(is-connected,setdiff(lcon(here),%q0))]=The disposal burps discretely as it deals with the sorting protective gloves.;&amp;wearing_gloves me=}}}}
@Startup Master Sorting Computer=@drain me; @notify me
&amp;NUM Master Sorting Computer=3
&amp;CURRENTVALUE Master Sorting Computer=0
&amp;SET-DO Master Sorting Computer=-1
&amp;SETS Master Sorting Computer=0
&amp;TOTALVALUE Master Sorting Computer=0
&amp;SET-RE Master Sorting Computer=-1
&amp;SET-MI Master Sorting Computer=-1
&amp;SET-FA Master Sorting Computer=-1
&amp;SET-SO Master Sorting Computer=-1
&amp;SET-LA Master Sorting Computer=-1
&amp;SET-TI Master Sorting Computer=-1
&amp;SET-DX Master Sorting Computer=-1
@Va Master Sorting Computer=0
@Vb Master Sorting Computer=749722734
@Vc Master Sorting Computer=749721226
@Ouse Master Sorting Computer=examines the sorting computer.
@Use Master Sorting Computer=[u(sorthelp1)]
@Desc Master Sorting Computer=A standard sorting table. There are a wide variety of computer sensors and lens on its surface. On the right is a large computer monitor. The left side of the table is just right for placing a carton upon, the protected middle is where the crystals are laid while being analyzed. The sorting computer is currently set to the scale of [edit(secure(v(currentscale)), -,&#160;%b)]. [switch(words(v(crystal-list)),0,The table is currently empty.,{On the sorting table are [words(v(crystal-list))] crystal(s) cut by [name(extract(v(crystal-[first(v(crystal-list))]), 1, 1))]. To see details about the crystals, use 'list all'.%r%rThese crystals were installed by Sorter [v(sorter)].})]
&amp;CRYSTAL- Master Sorting Computer=0 0 0
&amp;SETSCALE2 Master Sorting Computer=@emit Setting computer scale to [capstr(edit(secure(%0), -,&#160;%b))].; @dolist v(scale) = {&amp;crystal-[v(set-##)] me = switch(v(set-##), -1, None, [extract(v(crystal-[v(set-##)]), 1, 11)] 0); &amp;set-## me=-1}; @fo me = {&amp;currentvalue me = 0; &amp;currentscale me = capstr(%0); &amp;scalenotes me = v(%0-scale); @emit Scale set. Valid notes:&#160;%[secure(v(scalenotes))%]; @trigger me/trap_problem = set scale; @notify me}
&amp;VALID-SCALES Master Sorting Computer=a-major a-minor a$sharp-major a$sharp-minor a$flat-major a$flat-minor b-major b-minor b$sharp-major b$sharp-minor b$flat-major b$flat-minor c-major c-minor c$sharp-major c$sharp-minor c$flat-major c$flat-minor d-major d-minor d$sharp-major d$sharp-minor d$flat-major d$flat-minor e-major e-minor e$sharp-major e$sharp-minor e$flat-major e$flat-minor f-major f-minor f$sharp-major f$sharp-minor f$flat-major f$flat-minor g-major g-minor g$sharp-major g$sharp-minor g$flat-major g$flat-minor
&amp;CURRENTSCALE Master Sorting Computer=f$sharp-major
&amp;SCALENOTES Master Sorting Computer=F$sharp G$sharp A$sharp B C$sharp D$sharp F F$sharp
&amp;TWEAKSCALE Master Sorting Computer=lcstr(edit(edit(edit(%0,&#160;%b, $), $major, -major), $minor, -minor))
&amp;SETOUTPUT Master Sorting Computer=secure([extract(%0, 3, 1)], [extract(%0, 10, 1)] [extract(%0, 6, 1)] [extract(%0, 5, 1)] [extract(%0, 4, 1)], [extract(%0, 9, 1)])
&amp;HELP Master Sorting Computer=$sort help: @pemit&#160;%# = u(use)
&amp;CRYSTAL_DB Master Sorting Computer=#2000
&amp;OUTPUT_UNASSIGNED Master Sorting Computer=[rjust(%0, 3)]%b[secure([ljust(extract(%1, 3, 1), 8)][ljust(extract(%1, 10, 1), 13)][ljust(extract(%1, 6, 1), 10)][ljust(extract(%1, 5, 1), 7)][ljust(extract(%1, 4, 1), 13)][extract(%1, 9, 1)])]
&amp;LIST-UNASSIGNED Master Sorting Computer=$list u*:@swi words(v(crystal-list)) = 0,{@pemit&#160;%# = There are no crystals on the table currently.},{@pemit&#160;%#=Unassigned crystals on table:%r%rNum Note%b%b%b%bSize[space(9)]Shade[space(5)]Color%b%bShape[space(8)]Clarity%r--- ------- ------------ --------- ------ ------------ --------------;@dolist lnum(words(v(crystal-list)))={@swi extract(v(crystal-[extract(v(crystal-list), add(##, 1), 1)]), 12, 1)= 0,{@pemit&#160;%# = u(output_unassigned, add(##, 1), v(crystal-[extract(v(crystal-list), add(##, 1), 1)]))}}}
&amp;PARENT_CARTON Master Sorting Computer=#589
&amp;REPACK Master Sorting Computer=$repack*:@swi or(elock(v(sorter_lock),&#160;%#),strmatch(extract(v(crystal-[first(v(crystal-list))]), 1, 1),&#160;%#))=1,{@wait me={&amp;debug_table me = repack&#160;%0; @swi/first [setq(1, switch(%0, * label*=*, [setq(2, after(%0, =))]before(%0, label), [setq(2, )]%0))][setq(1, setunion(%q1,))][setq(0, setunion(u(#3392/expand_number_range, switch(words(%q1), 0, all, trim(%q1)), v(crystal-list)),))][setq(0,switch(strmatch(%q0,*ABORT*),1,%q0,sort(%q0,n)))]1 = and(gt(words(%q2), 0), not(ok_name(%q2))), {@pemit&#160;%# = Label contains invalid characters.; @no me}, eq(words(v(crystal-list)), 0),{@pemit&#160;%# = There are no crystals on the table.;@no me},strmatch(r(0), *ABORT*),{@pemit&#160;%# = after(before(r(0), ENDABORT), ABORT);@no me},{@vd me =&#160;; @dolist r(0) ={@swi extract(v(crystal-##), 12, 1) = 0,{@vd me =&#160;%vd ##;}}; @swi 1 = 1, {@swi 2 = 2, {@trigger me/do-repack =&#160;%#,&#160;%q2 }}} }},{@pemit&#160;%#=Permission denied.}
&amp;DO-REPACK Master Sorting Computer=@swi words(%vd) = 0,{@pemit&#160;%0 = None of the specified crystals are unassigned.%b Depending on the circumstances, either 'unselect &lt;note&gt;' (where note may be:%b%bdo re mi fa so la ti dx), 'uncommit &lt;set number&gt;', or do a 'start over'.; @no me},{@clone/inventory/parent [v(parent_carton)] = Storage Carton - [name(extract(v(crystal-[first(%vd)]), 1, 1))][switch(words(%1),0,,{%b Label:%b&#160;%1})];&amp;secured_type [con(me)] = carton to store crystal; @set [con(me)] = enter_ok; @set [con(me)] =&#160;!visual; &amp;tuner [con(me)]=[v(tuner)]; &amp;sorter [con(me)]=[v(sorter)]; @chown [con(me)] = #2; @set [con(me)] =&#160;!halt; @set [con(me)] = quiet; @drain [con(me)]; @no [con(me)]; @lock/receive [con(me)]=@[v(chit_lock)];@lock/enter [con(me)]=@[v(chit_lock)];@lock [con(me)]=@[v(carry_carton_lock)]; &amp;date_packed [con(me)] = time(); @dolist&#160;%vd = {&amp;num [con(me)] = add(get(con(me)/num), 1); &amp;crystal-[get(con(me)/num)] [con(me)] = extract(v(crystal-##), 1, 11); &amp;crystal-## me =&#160;; &amp;crystal-list me = s(remove(v(crystal-list), ##)); }; @swi 1 = 1,{@emit [name(%0)] carefully repacks [words(%vd)] crystal(s) into a storage carton to be sorted at another time.; @tel [con(me)] = loc(me); @vd me =&#160;; @no me}}
&amp;MARKETING_LOCK Master Sorting Computer=#727
&amp;CRYSTAL_SEARCH Master Sorting Computer=$crystal search *:@swi or(elock(v(sorter_lock),&#160;%#), v(marketing_lock),&#160;%#) = 1, {@pemit&#160;%# = You tap a few keys on the online terminal, entering a password, carefully shielding the movement of your fingers in case anyone is watching.; &amp;X-LIST me = u(v(market_data)/V-SEARCHnew,&#160;%0); @pemit&#160;%# = Search Completed: [words(v(X-LIST))] crystals match required specifications.%r'list search results' to view list.; @oemit&#160;%#=&#160;%N taps a few keys on the online terminal, entering search specifications, carefully hiding the movements of&#160;%p fingers.}, {@emit Several lights on the computer flash red, and a loud buzzer goes off.%b A pleasant voice says, &quot;Permission denied.&quot;}
&amp;DISPLAY_SEARCH_RESULTS Master Sorting Computer=$list search result*:@swi or(elock(v(sorter_lock),&#160;%#), v(marketing_lock),&#160;%#) = 1,{@pemit&#160;%# = You hit the key to show the display.; @pemit&#160;%#= u(W-HEADER); @trigger me/S-DISPLAY[gt(words(v(X-LIST)), 0)][lt(words(v(X-LIST)), 9)] =&#160;%#,v(X-LIST)}, {@emit Several lights on the computer flash red, and a loud buzzer goes off.%b A pleasant voict the current group aside, use when you're satisfied with value.%runcommit &lt;set number&gt;: uncommit the specified set group%r%rcurrent total: Displays the current commited total.%r%rstart over: ungroup all groups and start over with this batch of crystal.%r%rrepack: puts the crystals not assigned back into a carton.%r(repack also has optional parameter specifying list of crystals)%r(you may also specify optional parameter 'label=&lt;text&gt;' on repack)%r%rsort spam: build up a +mail listing the current groups on the table. You must first be sending a +mail.%rreport: Shows you what would go into the sort spam +mail.%r%rsell: credit the Singer with the total value and pack crystal for storage.%r%r[switch(words(v(sorthelp3)),0,,'sort help3'%r)]
&amp;CARRY_CARTON_LOCK Master Sorting Computer=#6727
&amp;HEADER Master Sorting Computer=Matching crystals on table:%r%rNum Note%b%b%b%bSize[space(9)]Shade[space(5)]Color%b%bShape[space(3)]Clarity%r--- ------- ------------ --------- ------ ------- ---------------
&amp;LIST-GROUP Master Sorting Computer=$list grouping *: @switch/first 0[setq(0,u(find_set_crystals,&#160;%0))]=words(%q0), {@pemit&#160;%#=There is no set by that number.}, {@pemit&#160;%#=u(header); @dolist&#160;%q0= {@pemit&#160;%#=[rjust(##, 3)]%b[u(output, v(crystal-##))]}}
&amp;LIST-IMPERFECT Master Sorting Computer=$list imperfect*:@swi words(v(crystal-list)) = 0,{@pemit&#160;%# = There are no crystals on the table currently.},{@swi [setq(2,grab(%0,u*))][setq(1,s(iter(v(crystal-list),[switch(match(perfect,[extract(v(crystal-##),9,1)]),0,##)])))][setq(1,[switch(words(%q2),1,filter(me/is-unass,%q1),%q1)])][words(%q1)]=0,{@pemit&#160;%#=No matching crystals.},{@pemit&#160;%#=[u(header)];@dolist&#160;%q1={@pemit&#160;%# =[rjust(member(v(crystal-list),##), 3)]%b[u(output, v(crystal-##))]};@oemit&#160;%#=[switch(role(%#),Sorter,[u(peer-[rand(3)])],%N looks the crystals over.)]}}
&amp;LIST-PERFECT Master Sorting Computer=$list perfect*:@swi words(v(crystal-list)) = 0,{@pemit&#160;%# = There are no crystals on the table currently.},{@swi [setq(2,grab(%0,u*))][setq(1,s(iter(v(crystal-list),[switch(match(perfect,[extract(v(crystal-##),9,1)]),0,,##)])))][setq(1,[switch(words(%q2),1,filter(me/is-unass,%q1),%q1)])][words(%q1)]=0,{@pemit&#160;%#=No matching crystals.},{@pemit&#160;%#=[u(header)];@dolist&#160;%q1={@pemit&#160;%# =[rjust(member(v(crystal-list),##), 3)]%b[u(output, v(crystal-##))]};@oemit&#160;%#=[switch(role(%#),Sorter,[u(peer-[rand(3)])],%N looks the crystals over.)]}}
&amp;DO_REVIEW_GRPVAL Master Sorting Computer=$value group *:@switch [and(lte(%0,v(sets)),sign(match(lattr(me/set_*_value),set_%0_value)))]=1,{@pemit&#160;%#=Value of grouping&#160;%0: [v(set_%0_value)]},{@pemit&#160;%#=No such grouping.}
&amp;EMPTY_CARTON Master Sorting Computer=@dolist lcon(%0)={drop ##}; @swi 1 = 1, {@dest&#160;%0}
&amp;RESET_TABLE Master Sorting Computer=$reset table: @pemit #5521=table reset [num(me)] [name(me)] reset by&#160;%N on [time()] semaphore = [v(semaphore)] debug = [v(debug)]; @drain me; @no me; @pemit&#160;%# = Reset.
&amp;TUNER_CARTON_LOCK Master Sorting Computer=#6913
&amp;CURRENTTOTAL Master Sorting Computer=$current total:@emit The computer flashes up the current total as [v(totalvalue)].
&amp;LIST-CLARITY Master Sorting Computer=$list clarity *:@swi words(v(crystal-list)) = 0,{@pemit&#160;%# = There are no crystals on the table currently.},{@swi [setq(2,grab(%0,u*))][setq(3,remove(%0,%q2))][setq(0,[edit(%q3,%b,$)])][setq(1,s(iter(v(crystal-list),[switch(match(%q0,[extract(v(crystal-##),9,1)]),0,,##)])))][setq(1,[switch(words(%q2),1,filter(me/is-unass,%q1),%q1)])][words(%q1)]=0,{@pemit&#160;%#=No matching crystals.},{@pemit&#160;%#=[u(header)];@dolist&#160;%q1={@pemit&#160;%# =[rjust(member(v(crystal-list),##), 3)]%b[u(output, v(crystal-##))]};@oemit&#160;%#=[switch(role(%#),Sorter,[u(peer-[rand(3)])],%N looks the crystals over.)]}}
&amp;SETSTRINGS Master Sorting Computer=octave 5-chord 5-row 5-row 5-row 5-row 4-chord 4-row 4-row 4-row 4-row 4-row 3-chord 3-row 3-row 3-row 3-row 3-row 3-row single single single single single single single single
&amp;LIST-WORST-STRING Master Sorting Computer=switch(words(%0), 0,#-1, 1, member(%1,%0), min(member(%1, first(%0)), u(list-worst-string, rest(%0),&#160;%1)))
&amp;SET-WORST-STRING Master Sorting Computer=extract(%2,u(list-worst-string, u(ex-set,&#160;%0),&#160;%1),1)
&amp;RG-CLARITY-SHORT Master Sorting Computer=MF F SF VSF P
&amp;ONE-SET Master Sorting Computer=switch(%5,very$large,Very large,large,Large,medium$large,Medium large,medium,Medium,medium$small,Medium small,small,Small,very$small,Very small,tiny,Tiny), [switch(%3,very$pale,very pale,rich$deep,rich deep,%3)]&#160;%2,&#160;%1[switch(%0,single,,%b%0)][switch(%4,P,,{%b(%4)})]
&amp;DO_MAIL Master Sorting Computer=$sort spam:@switch [setq(0,get(#7/mailbox_%#))][setq(1,get(%q0/mail-in-progress))]%q1=true,{@dolist [lnum(1,add(v(sets),1))]={@switch [words(u(find_set_crystals,##))]=0,,{&amp;mail-in-progress-body&#160;%q0 = [get(%q0/mail-in-progress-body)]%r(##) [v(string-##)]: [v(set_##_value)] credits;@pemit&#160;%#=Text added.}};@wait 2=@force&#160;%#=-%%r%%rTotal before tithe: [v(totalvalue)] credits%%rTotal after tithe: [div(mul(v(totalvalue), 70), 100)] credits%%r},{@pemit&#160;%#=You should start a mail message before you do that.}
&amp;DO_MAIL_SAVE Master Sorting Computer=$sort spam:@dolist [lnum(1,add(v(sets),1))]=@switch [words(u(find_set_crystals,##))]=0,,{@force&#160;%#=-%%r(##) [v(string-##)]: [v(set_##_value)] credits};@wait 2=@force&#160;%#=-%%r%%rTotal before tithe: [v(totalvalue)] credits%%rTotal after tithe: [div(mul(v(totalvalue), 70), 100)] credits
@set Master Sorting Computer/DO_MAIL_SAVE = no_command
&amp;DEMAND Master Sorting Computer=100
&amp;LIST-SHADE Master Sorting Computer=$list shade *:@swi words(v(crystal-list)) = 0,{@pemit&#160;%# = There are no crystals on the table currently.},{@swi [setq(2,grab(%0,u*))][setq(3,remove(%0,%q2))][setq(0,[edit(%q3,%b,$)])][setq(1,s(iter(v(crystal-list),[switch(match([extract(v(crystal-##),6,1)],%q0*),0,,##)])))][setq(1,[switch(words(%q2),1,filter(me/is-unass,%q1),%q1)])][words(%q1)]=0,{@pemit&#160;%#=No matching crystals.},{@pemit&#160;%#=[u(header)];@dolist&#160;%q1={@pemit&#160;%# =[rjust(member(v(crystal-list),##), 3)]%b[u(output, v(crystal-##))]}}}
&amp;CMD_REPORT Master Sorting Computer=$report:@dolist [lnum(1,add(v(sets),1))]={@switch [words(u(find_set_crystals,##))]=0,,{@pemit&#160;%#=(##) [v(string-##)]: [v(set_##_value)] credits}};@wait 1=@pemit&#160;%#=Total before tithe: [v(totalvalue)] credits%rTotal after tithe: [div(mul(v(totalvalue),70),100)] credits.
&amp;CHIT_LOCK Master Sorting Computer=#10253
&amp;IS-UNASS Master Sorting Computer=[switch(extract(v(crystal-%0),12,1),0,1,0)]
&amp;LIST-NOTE-SAVE Master Sorting Computer=$list note *:@swi words(v(crystal-list)) = 0,{@pemit&#160;%# = There are no crystals on the table currently.},{@pemit&#160;%#=[setq(0,[edit(%0,%b,$)] [v([edit(%0,%b,$)]_ALT)])][u(header)];@dolist lnum(words(v(crystal-list)))={@swi [sign(match(%q0,[extract(v(crystal-[extract(v(crystal-list), add(##, 1), 1)]), 3, 1)]))]= 1,{@pemit&#160;%# =[rjust(add(##, 1), 3)]%b[u(output, v(crystal-[extract(v(crystal-list), add(##, 1), 1)]))]}}}
@set Master Sorting Computer/LIST-NOTE-SAVE = no_command
&amp;TAP-0 Master Sorting Computer=%N taps several of the crystals and listens to their pure tones.
&amp;TAP-1 Master Sorting Computer=%N gently taps&#160;%p crystal hammer against some crystals, their pure tones hang in the air.
&amp;TAP-2 Master Sorting Computer=The pure tones of the crystals ring out as&#160;%N taps them with&#160;%p crystal hammer.
&amp;LIST-SHAPE-SAVE Master Sorting Computer=$list shape *:@swi words(v(crystal-list)) = 0,{@pemit&#160;%# = There are no crystals on the table currently.},{@pemit&#160;%#=[u(header)];@dolist lnum(words(v(crystal-list)))={@swi match(secure(extract(v(crystal-[extract(v(crystal-list), add(##, 1), 1)]), 4, 1)),%0*)=0,,{@pemit&#160;%# =[rjust(add(##, 1), 3)]%b[u(output, v(crystal-[extract(v(crystal-list), add(##, 1), 1)]))]}}}
@set Master Sorting Computer/LIST-SHAPE-SAVE = no_command
&amp;LIST-CLARITY-SAVE Master Sorting Computer=$list clarity *:@swi words(v(crystal-list)) = 0,{@pemit&#160;%# = There are no crystals on the table currently.},{@pemit&#160;%#=[u(header)];@dolist lnum(words(v(crystal-list)))={@swi secure(extract(v(crystal-[extract(v(crystal-list), add(##, 1), 1)]), 9, 1))=&#160;%0,{@pemit&#160;%# =[rjust(add(##, 1), 3)]%b[u(output, v(crystal-[extract(v(crystal-list), add(##, 1), 1)]))]}}}
@set Master Sorting Computer/LIST-CLARITY-SAVE = no_command
&amp;PEER-0 Master Sorting Computer=%N blinks&#160;%p eyes into the enhanced mode and peers at the crystals.
&amp;PEER-1 Master Sorting Computer=%N peers at the crystals with&#160;%p reddish eyes, examining them for flaw.
&amp;PEER-2 Master Sorting Computer=%N evaluates the crystals for flaw using&#160;%p enhanced vision.
&amp;LIST-SHADE-SAVE Master Sorting Computer=$list shade *:@swi words(v(crystal-list)) = 0,{@pemit&#160;%# = There are no crystals on the table currently.},{@pemit&#160;%#=[u(header)];@dolist lnum(words(v(crystal-list)))={@swi match(secure(extract(v(crystal-[extract(v(crystal-list), add(##, 1), 1)]), 6, 1)),%0*)=0,,{@pemit&#160;%# =[rjust(add(##, 1), 3)]%b[u(output, v(crystal-[extract(v(crystal-list), add(##, 1), 1)]))]}}}
@set Master Sorting Computer/LIST-SHADE-SAVE = no_command
&amp;LIST-SIZE-SAVE Master Sorting Computer=$list size *:@swi words(v(crystal-list)) = 0,{@pemit&#160;%# = There are no crystals on the table currently.},{@pemit&#160;%#=[u(header)];@dolist lnum(words(v(crystal-list)))={@swi secure(extract(v(crystal-[extract(v(crystal-list), add(##, 1), 1)]), 10, 1))=&#160;%0,{@pemit&#160;%# =[rjust(add(##, 1), 3)]%b[u(output, v(crystal-[extract(v(crystal-list), add(##, 1), 1)]))]}}}
@set Master Sorting Computer/LIST-SIZE-SAVE = no_command
&amp;LIST-IMPERFECT-SAVE Master Sorting Computer=$list imperfect:@swi words(v(crystal-list)) = 0,{@pemit&#160;%# = There are no crystals on the table currently.},{@pemit&#160;%#=[u(header)];@dolist lnum(words(v(crystal-list)))={@swi secure(extract(v(crystal-[extract(v(crystal-list), add(##, 1), 1)]), 9, 1))= perfect,{},{@pemit&#160;%# =[rjust(add(##, 1), 3)] [u(output, v(crystal-[extract(v(crystal-list), add(##, 1), 1)]))]}}}
@set Master Sorting Computer/LIST-IMPERFECT-SAVE = no_command
&amp;LIST-PERFECT-SAVE Master Sorting Computer=$list perfect:@swi words(v(crystal-list)) = 0,{@pemit&#160;%# = There are no crystals on the table currently.},{@pemit&#160;%#=[u(header)];@dolist lnum(words(v(crystal-list)))={@swi secure(extract(v(crystal-[extract(v(crystal-list), add(##, 1), 1)]), 9, 1))= perfect,{@pemit&#160;%# =[rjust(add(##, 1), 3)] [u(output, v(crystal-[extract(v(crystal-list), add(##, 1), 1)]))]}}}
@set Master Sorting Computer/LIST-PERFECT-SAVE = no_command
&amp;SECURED_TYPE Master Sorting Computer=sorter medprivs
&amp;COMMIT_OLD Master Sorting Computer=commit:@swi elock(v(sorter_lock),&#160;%#)=1,{@wait me = {&amp;debug_#2755 me = commit; @switch/first 0 = v(currentvalue),{@pemit&#160;%# = You must 'evaluate' the set first.; @notify me},words(u(ex-set, 1)),{@pemit&#160;%#=You can't commit an empty group.; @notify me},{&amp;sets me = add(v(sets), 1);&amp;string-[v(sets)] me=u(one-set,[extract(v(setstrings),member(v(rg-setpattern), u(setpattern)), 1)],[extract(v(rg-shape),member(v(rg-shape), first(u(ex-set, 4))),1)],[extract(v(rg-color),member(v(rg-color), first(u(ex-set, 5))),1)],[extract(v(rg-shade),member(v(rg-shade), first(u(ex-set, 6))),1)],[u(set-worst-string,9,v(rg-clarity),v(rg-clarity-short))],[u(set-worst-string,10,v(rg-size),v(rg-size))]);@dolist v(scale) = {&amp;crystal-[v(set-##)] me = switch(v(set-##), -1, None, [extract(v(crystal-[v(set-##)]), 1, 11)] [v(sets)]/##);&amp;set-## me = -1};@swi 1 = 1, {&amp;totalvalue me = add(v(totalvalue), v(currentvalue)); &amp;set_[v(sets)]_value me = v(currentvalue); &amp;currentvalue me = 0; @emit&#160;%N labels this group of crystals and sets it aside. Total value now:%b%b[v(totalvalue)].; @notify me}}}},{@pemit&#160;%# = Permission denied.}
&amp;INJCHANCE Master Sorting Computer=[switch(member(v(wearing_gloves),&#160;%#),0,[v(base_injchance)],[add(v(base_injchance),300)])]
&amp;INJURIES Master Sorting Computer=3
&amp;INJURY-0 Master Sorting Computer=%N has a deep gash across the palm of&#160;%p right hand.
&amp;INJMESS-0 Master Sorting Computer=As you set aside the group one of the crystals slips and slices the palm of your right hand[switch(match(v(wearing_gloves),%#),0,,{, cutting through the protective glove})]. Thankfully you don't drop it and set it safely with the others.
&amp;OINJMESS-0 Master Sorting Computer=As&#160;%N sets aside the group, one of the crystals slips and slices the palm of&#160;%p right hand. Thankfully&#160;%s doesn't drop it and sets it safely with the others.
&amp;INJMESS-1 Master Sorting Computer=As you set aside the group one of the crystals slips and slices the palm of your left hand[switch(match(v(wearing_gloves),%#),0,,{, cutting through the protective glove})]. Thankfully you don't drop it and pack it safely away.
&amp;INJURY-1 Master Sorting Computer=%N has a deep gash across the palm of&#160;%p left hand.
&amp;INJURY-2 Master Sorting Computer=%N's right wrist is swollen, most likely sprained.
&amp;INJMESS-2 Master Sorting Computer=As you turn back to the table after setting aside the group of crystals, your foot slips on a wet spot on the floor and you fall down hard, spraining your right wrist.
&amp;OINJMESS-2 Master Sorting Computer=After&#160;%N sets aside the group and turns back to the table,&#160;%p foot slips on a wet spot of the floor and&#160;%s goes down hard on&#160;%p right arm.
&amp;OINJMESS-1 Master Sorting Computer=As&#160;%N sets aside the group, one of the crystals slips and slices the palm of&#160;%p left hand. Thankfully&#160;%s doesn't drop it and sets it safely with the others.
&amp;MEDICAL_CONTROL Master Sorting Computer=#25
&amp;WEAR_GLOVES Master Sorting Computer=$wear gloves:@swi [elock(v(sorter_lock),&#160;%#)]+[member(v(wearing_gloves),%#)]=1+0,{&amp;wearing_gloves me=[setunion(v(wearing_gloves),&#160;%#)]; @pemit&#160;%#=You grab some protective gloves from the dispenser on the table and pull them on.; @oemit&#160;%#=%N grabs some protective gloves from the table compartment and pulls them on.},1+*,{@pemit&#160;%#=You're already wearing gloves!},{@pemit&#160;%#=You aren't a sorter. You don't need gloves.}
&amp;HERE_WITH_GLOVES Master Sorting Computer=[strmatch(loc(%0),loc(me))]
&amp;BASE_INJCHANCE Master Sorting Computer=400
&amp;IS-CONNECTED Master Sorting Computer=and(strmatch(type(%0), PLAYER), hasflag(%0, CONNECTED))
@set Master Sorting Computer=INHERIT
@set Master Sorting Computer=QUIET
@set Master Sorting Computer=VISUAL
@set Master Sorting Computer=SAFE
@set Master Sorting Computer=COMMANDS

</pre>

<!-- 
NewPP limit report
CPU time usage: 0.014 seconds
Real time usage: 0.018 seconds
Preprocessor visited node count: 4/1000000
Preprocessor generated node count: 24/1000000
Postâ€expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key homesitewiki-mw_:pcache:idhash:645-0!*!*!*!*!*!* and timestamp 20160813125302
 -->
</div>								<div class="printfooter">
				Retrieved from "<a href="http://www.gwen-morse.com/wiki/index.php?title=Master_Sorting_Computer&amp;oldid=2512">http://www.gwen-morse.com/wiki/index.php?title=Master_Sorting_Computer&amp;oldid=2512</a>"				</div>
												<div id='catlinks' class='catlinks catlinks-allhidden'></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
				<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
	<h3 id="p-personal-label">Personal tools</h3>
	<ul>
<li id="pt-login"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Master+Sorting+Computer" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>	</ul>
</div>
				<div id="left-navigation">
					<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
	<h3 id="p-namespaces-label">Namespaces</h3>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="/wiki/index.php/Master_Sorting_Computer"  title="View the content page [c]" accesskey="c">Page</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="/wiki/index.php?title=Talk:Master_Sorting_Computer&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
			</ul>
</div>
<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
	<h3 id="mw-vector-current-variant">
		</h3>
	<h3 id="p-variants-label"><span>Variants</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
				</div>
				<div id="right-navigation">
					<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
	<h3 id="p-views-label">Views</h3>
	<ul>
					<li id="ca-view" class="selected"><span><a href="/wiki/index.php/Master_Sorting_Computer" >Read</a></span></li>
					<li id="ca-viewsource"><span><a href="/wiki/index.php?title=Master_Sorting_Computer&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
					<li id="ca-history" class="collapsible"><span><a href="/wiki/index.php?title=Master_Sorting_Computer&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
			</ul>
</div>
<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
	<h3 id="p-cactions-label"><span>Actions</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
<div id="p-search" role="search">
	<h3><label for="searchInput">Search</label></h3>
	<form action="/wiki/index.php" id="searchform">
				<div id="simpleSearch">
						<input name="search" placeholder="Search" title="Search Gwen Morse's Wiki [f]" accesskey="f" id="searchInput" />						<button type="submit" name="button" title="Search the pages for this text" id="searchButton"><img src="/wiki/skins/vector/images/search-ltr.png?303" alt="Search" width="12" height="13" /></button>								<input type='hidden' name="title" value="Special:Search"/>
		</div>
	</form>
</div>
				</div>
			</div>
			<div id="mw-panel">
					<div id="p-logo" role="banner"><a style="background-image: url(/home/public/wiki/guestbook.jpg);" href="/wiki/index.php/Main_Page"  title="Visit the main page"></a></div>
				<div class="portal" role="navigation" id='p-navigation' aria-labelledby='p-navigation-label'>
	<h3 id='p-navigation-label'>Navigation</h3>
	<div class="body">
		<ul>
			<li id="n-mainpage-description"><a href="/wiki/index.php/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
			<li id="n-MUSHing"><a href="/wiki/index.php/MUSHing">MUSHing</a></li>
			<li id="n-Softcode-Archive"><a href="/wiki/index.php/Gwen%27s_MUSHcode_Archive">Softcode Archive</a></li>
			<li id="n-Tinyfugue-Client"><a href="/wiki/index.php/Tinyfugue">Tinyfugue Client</a></li>
			<li id="n-Tabletop-Roleplay"><a href="/wiki/index.php/Roleplay">Tabletop Roleplay</a></li>
			<li id="n-Sims"><a href="/wiki/index.php/Sims">Sims</a></li>
			<li id="n-Linux"><a href="/wiki/index.php/Linux">Linux</a></li>
			<li id="n-Health-and-Beauty"><a href="/wiki/index.php/HABA">Health and Beauty</a></li>
			<li id="n-Recipes"><a href="/wiki/index.php/Recipes">Recipes</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-Wiki_Help' aria-labelledby='p-Wiki_Help-label'>
	<h3 id='p-Wiki_Help-label'>Wiki Help</h3>
	<div class="body">
		<ul>
			<li id="n-portal"><a href="/wiki/index.php/Gwen_Morse%27s_Wiki:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
			<li id="n-currentevents"><a href="/wiki/index.php/Gwen_Morse%27s_Wiki:Current_events" title="Find background information on current events">Current events</a></li>
			<li id="n-recentchanges"><a href="/wiki/index.php/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
			<li id="n-randompage"><a href="/wiki/index.php/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
			<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" rel="nofollow" title="The place to find out">Help</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
	<h3 id='p-tb-label'>Tools</h3>
	<div class="body">
		<ul>
			<li id="t-whatlinkshere"><a href="/wiki/index.php/Special:WhatLinksHere/Master_Sorting_Computer" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
			<li id="t-recentchangeslinked"><a href="/wiki/index.php/Special:RecentChangesLinked/Master_Sorting_Computer" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
			<li id="t-specialpages"><a href="/wiki/index.php/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
			<li id="t-print"><a href="/wiki/index.php?title=Master_Sorting_Computer&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
			<li id="t-permalink"><a href="/wiki/index.php?title=Master_Sorting_Computer&amp;oldid=2512" title="Permanent link to this revision of the page">Permanent link</a></li>
			<li id="t-info"><a href="/wiki/index.php?title=Master_Sorting_Computer&amp;action=info">Page information</a></li>
		</ul>
	</div>
</div>
			</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 8 August 2014, at 23:32.</li>
											<li id="footer-info-viewcount">This page has been accessed 864 times.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="/wiki/index.php/Gwen_Morse%27s_Wiki:Privacy_policy" title="Gwen Morse's Wiki:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="/wiki/index.php/Gwen_Morse%27s_Wiki:About" title="Gwen Morse's Wiki:About">About Gwen Morse&#039;s Wiki</a></li>
											<li id="footer-places-disclaimer"><a href="/wiki/index.php/Gwen_Morse%27s_Wiki:General_disclaimer" title="Gwen Morse's Wiki:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
					<li id="footer-poweredbyico">
						<a href="//www.mediawiki.org/"><img src="/wiki/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","skins.vector.collapsibleNav"],null,true);
}</script>
<script>if(window.mw){
mw.loader.state({"site":"ready"});
}</script>
<!-- Served in 0.486 secs. -->
	</body>
</html>
