<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Code: Moe&#39;s +wear class (Part 2)</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <!-- Apple devices fullscreen -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <!-- Apple devices fullscreen -->
    <meta names="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <!-- Bootstrap -->
	<link rel="stylesheet" href="../Theme/Flat/html/css/bootstrap.min.css">
	<!-- Bootstrap responsive -->
	<link rel="stylesheet" href="../Theme/Flat/html/css/bootstrap-responsive.min.css">
	<!-- jQuery UI -->
	<link rel="stylesheet" href="../Theme/Flat/html/css/plugins/jquery-ui/smoothness/jquery-ui.css">
	<link rel="stylesheet" href="../Theme/Flat/html/css/plugins/jquery-ui/smoothness/jquery.ui.theme.css">
	<!-- Theme CSS -->
	<link rel="stylesheet" href="../Theme/Flat/html/css/style.css">
	<!-- Color CSS -->
	<link rel="stylesheet" href="../Theme/Flat/html/css/themes.css">


    <link rel="stylesheet" href="../Content/site.css">

    <!-- jQuery -->
    <script src="../Theme/Flat/html/js/jquery.min.js"></script>
    <!-- Nice Scroll -->
    <script src="../Theme/Flat/html/js/plugins/nicescroll/jquery.nicescroll.min.js"></script>
    <!-- jQuery UI -->
    <script src="../Theme/Flat/html/js/plugins/jquery-ui/jquery.ui.core.min.js"></script>
    <script src="../Theme/Flat/html/js/plugins/jquery-ui/jquery.ui.widget.min.js"></script>
    <script src="../Theme/Flat/html/js/plugins/jquery-ui/jquery.ui.mouse.min.js"></script>
    <script src="../Theme/Flat/html/js/plugins/jquery-ui/jquery.ui.resizable.min.js"></script>
    <script src="../Theme/Flat/html/js/plugins/jquery-ui/jquery.ui.sortable.min.js"></script>
    <!-- slimScroll -->
    <script src="../Theme/Flat/html/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
    <!-- Bootstrap -->
    <script src="../Theme/Flat/html/js/bootstrap.min.js"></script>
    <!-- Form -->
    <script src="../Theme/Flat/html/js/plugins/form/jquery.form.min.js"></script>

    <!-- Theme framework -->
    <script src="../Theme/Flat/html/js/eakroko.min.js"></script>
    <!-- Theme scripts -->
    <script src="../Theme/Flat/html/js/application.min.js"></script>

    <!--[if lte IE 9]>
		<script src="js/plugins/placeholder/jquery.placeholder.min.js"></script>
		<script>
			$(document).ready(function() {
				$('input, textarea').placeholder();
			});
		</script>
	<![endif]-->

    <!-- Favicon -->
    <link rel="shortcut icon" href="http://www.mushcode.com/File/img/favicon.ico" />
    <!-- Apple devices Homescreen icon -->
    <link rel="apple-touch-icon-precomposed" href="http://www.mushcode.com/File/img/apple-touch-icon-precomposed.png" />

</head>

<body class="theme-green">
    <div id="navigation">
        <div class="container-fluid">
            <a href="../index.html" id="brand">MUSHCode.com</a>
        </div>
    </div>
    <div class="container-fluid" id="content">
        <div id="left">
            <div class="subnav">
                <div class="subnav-title">
                    <a href="Moes-Pluswear-class-(Part-2).html#" class='toggle-subnav'>
                        <i class="icon-angle-down"></i>
                        <span>About</span>
                    </a>
                </div>
                <ul class="subnav-menu">
                    <li>
                        <a href="../index.html">Overview</a>
                    </li>
                </ul>
            </div>
            <div class="subnav">
                <div class="subnav-title">
                    <a href="Moes-Pluswear-class-(Part-2).html#" class='toggle-subnav'>
                        <i class="icon-angle-down"></i>
                        <span>Files</span>
                    </a>
                </div>
                <ul class="subnav-menu">
                    <li class='dropdown'>
                        <a href="Moes-Pluswear-class-(Part-2).html#" data-toggle="dropdown">Code</a>
                        
<ul class="dropdown-menu">
        <li>
            <a href="../Category/Administration.html">Administration</a>
        </li>
        <li>
            <a href="../Category/Building.html">Building</a>
        </li>
        <li>
            <a href="../Category/Bulletin-Board.html">Bulletin Board</a>
        </li>
        <li>
            <a href="../Category/Combat.html">Combat</a>
        </li>
        <li>
            <a href="../Category/Dynamic-Space.html">Dynamic Space</a>
        </li>
        <li>
            <a href="../Category/Fonts.html">Fonts</a>
        </li>
        <li>
            <a href="../Category/Functions.html">Functions</a>
        </li>
        <li>
            <a href="../Category/Games.html">Games</a>
        </li>
        <li>
            <a href="../Category/Globals.html">Globals</a>
        </li>
        <li>
            <a href="../Category/Mail-Systems.html">Mail Systems</a>
        </li>
        <li>
            <a href="../Category/Other.html">Other</a>
        </li>
        <li>
            <a href="../Category/Schedulers.html">Schedulers</a>
        </li>
        <li>
            <a href="../Category/Time.html">Time</a>
        </li>
        <li>
            <a href="../Category/Vehicles.html">Vehicles</a>
        </li>
        <li>
            <a href="../Category/Vendors.html">Vendors</a>
        </li>
        <li>
            <a href="../Category/Weather-Systems.html">Weather Systems</a>
        </li>
</ul>
                    </li>
                    <li class='dropdown'>
                        <a href="Moes-Pluswear-class-(Part-2).html#" data-toggle="dropdown">Classes</a>
                        
<ul class="dropdown-menu">
        <li>
            <a href="../Category/Administration.html">Administration</a>
        </li>
        <li>
            <a href="../Category/Building.html">Building</a>
        </li>
        <li>
            <a href="../Category/Globals.html">Globals</a>
        </li>
        <li>
            <a href="../Category/Hardcode.html">Hardcode</a>
        </li>
        <li>
            <a href="../Category/Other.html">Other</a>
        </li>
        <li>
            <a href="../Category/Softcode.html">Softcode</a>
        </li>
</ul>
                    </li>
                    <li>
                        <a href="../Manuals.html">Manuals</a>
                    </li>
                </ul>
            </div>
            <div class="subnav">
                <div class="subnav-title">
                    <a href="Moes-Pluswear-class-(Part-2).html#" class='toggle-subnav'>
                        <i class="icon-angle-down"></i>
                        <span>Misc</span>
                    </a>
                </div>
                <ul class="subnav-menu">
                    <li>
                        <a href="../Ascii2Mu.html">ASCII To MUSHCode</a>
                    </li>
                    <li>
                        <a href="../MushList.html">MUSH/MUX List</a>
                    </li>
                    <li>
                        <a href="../MushRoom.html">MUSHRoom</a>
                    </li>
                </ul>
            </div>
            <div class="subnav">
                <div class="subnav-title">
                    <a href="Moes-Pluswear-class-(Part-2).html#" class='toggle-subnav'>
                        <i class="icon-angle-down"></i>
                        <span>Contribute</span>
                    </a>
                </div>
                <ul class="subnav-menu">
                    <li>
                        <a href="../Submit.html">Submit</a>
                    </li>
                </ul>
            </div>
        </div>
        <div id="main">
            <div class="container-fluid">
                <div class="breadcrumbs">
                    <ul>
                        
    <li>
        <a href="../index.html">Home</a>
        <i class="icon-angle-right"></i>
    </li>
    <li>
        <a href="../Category/Globals.html">Globals</a>
        <i class="icon-angle-right"></i>
    </li>
    <li>
        <a href="Moes-Pluswear-class-(Part-2).html#">Moe&#39;s +wear class (Part 2)</a>
    </li>

                    </ul>
                </div>
                <div class="row-fluid">
                    <div class="span12">
                        



<div class="box">
    <div class="box-title title">
        <h2>
            Moe&#39;s +wear class (Part 2)
        </h2>
    </div>
    <div class="box-content">

        <div class="description">
            <p></p>
        </div>

        <div class="author">
            <strong>Author:</strong>
                <span>
                    <a href="../Author/Moe@OGR.html">Moe</a>@<a href="../Source/OGR.html">OGR</a>
                </span>
        </div>

        <div class="author">
            <strong>Category:</strong>
            <a href="../Category/Globals.html">Globals</a>
        </div>

            <div class="commands">
            <strong>Commands:</strong>
                    <a href="http://www.mushcode.com/Command/@describe" class="command">@describe</a>,
                    <a href="http://www.mushcode.com/Command/@lock" class="command">@lock</a>.
            </div>

            <div class="functions">
                <strong>Functions:</strong>
                        <a href="../Function/after.html" class="function">after&#40;&#41;</a>,
                        <a href="../Function/eval.html" class="function">eval&#40;&#41;</a>,
                        <a href="../Function/first.html" class="function">first&#40;&#41;</a>,
                        <a href="../Function/gt.html" class="function">gt&#40;&#41;</a>,
                        <a href="../Function/hasattr.html" class="function">hasattr&#40;&#41;</a>,
                        <a href="../Function/hasflag.html" class="function">hasflag&#40;&#41;</a>,
                        <a href="../Function/lattr.html" class="function">lattr&#40;&#41;</a>,
                        <a href="../Function/lcstr.html" class="function">lcstr&#40;&#41;</a>,
                        <a href="../Function/match.html" class="function">match&#40;&#41;</a>,
                        <a href="../Function/member.html" class="function">member&#40;&#41;</a>,
                        <a href="../Function/name.html" class="function">name&#40;&#41;</a>,
                        <a href="../Function/next.html" class="function">next&#40;&#41;</a>,
                        <a href="../Function/not.html" class="function">not&#40;&#41;</a>,
                        <a href="../Function/orflags.html" class="function">orflags&#40;&#41;</a>,
                        <a href="../Function/owner.html" class="function">owner&#40;&#41;</a>,
                        <a href="../Function/rest.html" class="function">rest&#40;&#41;</a>,
                        <a href="../Function/s.html" class="function">s&#40;&#41;</a>,
                        <a href="../Function/set.html" class="function">set&#40;&#41;</a>,
                        <a href="../Function/setq.html" class="function">setq&#40;&#41;</a>,
                        <a href="../Function/setr.html" class="function">setr&#40;&#41;</a>,
                        <a href="../Function/strmatch.html" class="function">strmatch&#40;&#41;</a>,
                        <a href="../Function/switch.html" class="function">switch&#40;&#41;</a>,
                        <a href="../Function/u.html" class="function">u&#40;&#41;</a>,
                        <a href="../Function/v.html" class="function">v&#40;&#41;</a>,
                        <a href="../Function/wipe.html" class="function">wipe&#40;&#41;</a>,
                        <a href="../Function/words.html" class="function">words&#40;&#41;</a>.
            </div>


            <div class="servers">
                <strong>Compatibility:</strong>
                        <a href="../Server/CobraMUSH.html" class="server">CobraMUSH</a>,
                        <a href="../Server/PennMUSH.html" class="server">PennMUSH</a>,
                        <a href="../Server/RhostMUSH.html" class="server">RhostMUSH</a>,
                        <a href="../Server/TinyBit.html" class="server">TinyBit</a>,
                        <a href="../Server/TinyMUSH.html" class="server">TinyMUSH</a>,
                        <a href="../Server/TinyMUX.html" class="server">TinyMUX</a>.
            </div>

    </div>
</div>


<div class="box box-bordered box-condensed">
    <div class="box-title">
        <h3>
	        <i class="icon-reorder"></i>
	        MUSHCode for Moe&#39;s +wear class (Part 2)
        </h3>
        <div class="actions">
	        <a class="btn btn-mini select-all" href="Moes-Pluswear-class-(Part-2).html#">
                    <i class="icon-resize-full"></i> Select Content
            </a>
        </div>
    </div>
    <div id="code" class="box-content content">
        OGR - Wednesday, October 25, 2000, 6:01 PM<br/>©2000 Moses@OGR. You may copy and redistribute this document provided<br/>that it remains complete, with credits intact, and is used only for<br/>non-profit purposes. <br/>------------------------------------------<br/><br/>Moses says "Okay, I am logging this for posting to the OGR webpage, so if you want yourself<br/>edited out, say so."<br/>Moses says "Alright, last time, eons ago, we worked on developing the +wear/list command. <br/>We're going to leave that one, as it is, for now."<br/>Aleriel has no probs with her words being posted<br/>Moses says "My goal with this class is the wholesale construction of lots of code, with the<br/>emphasis being on the building of the commands and ufuns, with the debugging, streamlining, <br/>etc, to come at the next(and probably final) class."<br/>Aleriel grins. "That sounds fun"<br/>Moses says "Since that is the way projects like this, a chargen, a faction system, and others<br/>work. You figure out what you want to do(last class), you give it your best shot(this class),<br/>and then you make it ready for public consumption(next class)"<br/>Moses says "This afternoon, I decided to put some stuff together to demonstrate more than one<br/>way to go about doing this. There's essentially two 'styles' of coding that can be used to do<br/>what we're trying to do. One style is dependent on ufuns and side-effect functions, and the<br/>other does everything with system commands."<br/>Moses says "And since we're designing one command with multiple switches, as we decided last<br/>class, it basically comes down to the usage of either switch() or @switch to decide which<br/>way to point our code to go."<br/>Moses says "now we hit the disclaimer part of this class. Each and every coder has their<br/>'style' that they like. Some people are even recognizable by the style in which they code.<br/>So, the code presented here, on the armoire is code done 'my' way. That does not mean that<br/>it is dogmatically the best way, etc, but it's the way I did it."<br/>Moses shoves that politically-correct statement over to the corner and goes on.<br/>Aleriel grins<br/>Moses says "For instance, you and I approached just the basic display of the +wear/list command<br/>quite differently at the last class, so this should be fun."<br/>Moses says "Okay, we decided that our command was going to take the structure of +wear *=*<br/>at the last class, at Parity's suggestion."<br/>Moses whoops.<br/>Moses says "+wear/* *=*"<br/>Moses says "That was it."<br/>Aleriel says "which * is what?"<br/>Moses grins.<br/>Moses is about to get to that.<br/>Aleriel nodnods<br/>Moses says "We decided the options we wanted for our +wear were to be able to add, delete,<br/>clear, and preview, based on two categories of descriptions. base and clothes."<br/>Moses says "However, given those command parameters, one of them quite clearly is going to<br/>give us problems with +wear/* *=*."<br/>Moses says "Two, actually, but one violates this protocol."<br/>Moses says "+wear/delete base=&lt;name&gt; is obviously okay."<br/>Moses says "+wear/preview clothes=&lt;name&gt; is also okay."<br/>Moses says "So, you look at the other two."<br/>Moses says "+wear/clear clothes......?"<br/>Aleriel hmms. "What's +wear/clear suppose to do in the first place?"<br/>Moses says "If you have &lt;section A&gt; and &lt;section B&gt; in your desc. +wear/clear &lt;a/b&gt; would<br/>'clear' that section from your desc, but not delete the description from your list."<br/>Aleriel ahs<br/>Moses nods. Just takes it out of the visible desc.<br/>Aleriel thinks +wear/clear clother=blah would work.. as long as you remember which part of<br/>your @desc is called what<br/>Moses nods. But why should you have to remember which is which? That makes it harder on the<br/>user.<br/>Aleriel says "True"<br/>Moses says "As coders, designing global systems, you have to make the assumption that your<br/>user is stupid."<br/>Moses says "I don't mean that to be rude."<br/>Moses says "But, it's the basic assumption that you have to make."<br/>Moses says "In this case, stupid means, they aren't going to know everything you know about<br/>the inner workings of the code, and also are not prone to copious note-taking or eidetic<br/>memories."<br/>Moses says "Now, there's a simple solution to the problem of command structure, but of<br/>course, the easier we make it for the user, the harder we make it for ourselves to code."<br/>Moses says "The ultimate designer's Catch-22"<br/>Moses says "What I did was to reduce the command to +wear/* *."<br/>Moses says "The second * will still catch all the text if someone does +wear/delete<br/>clothes=blueshirt"<br/>Moses says "Or, it will catch +wear/clear base"<br/>Aleriel ponders. "Either that, or two separate commands can be coded for +wear/add and<br/>+wear/clear"<br/>Moses nods. You could do that.<br/>Moses says "Which is a viable solution."<br/>Moses almost did that for the case of +wear/new, but I decided that the lesson needed to<br/>be shown of how to do everything in one command.<br/>Aleriel nods<br/>Moses says "So, if the command structure is reduced to +wear/* *, then the next step is<br/>obviously testing for an = sign."<br/>Moses says "And the easiest way to do that is....?"<br/>It's Audience Participation Time!<br/>Aleriel says "match() or strmatch()?"<br/>[Post-Class Note: imho means: In my honest opinion]<br/>Moses nods. those would both work. There's an, imho, easier solution.<br/>Moses says "Use the words() function."<br/>Aleriel nods<br/>Moses says "While the user is guaranteed to, at one point or another, give you bad data, you<br/>can make a gentle assumption that if they are using either new, delete, or preview, they<br/>are going to specify *=* as the next part of the command."<br/>Moses says "So, as long as you have at least 2 'words', separated by an =, you can be<br/>assured that they're not using 'clear'."<br/>Aleriel says "they could use '=' in the desc name too"<br/>Moses says "It's likely that they may have = in the desc name, but then it would return more<br/>than 2 words. And if you're testing gt(words(%1,=),1), it is still not a problem."<br/>Aleriel nods<br/>Moses says "As long as there's more than 1 'word' separated by '=', it's not clear."<br/>Moses says "I can liken this to Forensics, which may be a bad analogy, but it's something I<br/>know, so I can make it. :)"<br/>Aleriel grins<br/>Moses says "In Forensics, with DNA testing, and tire-track matching, etc..they don't match<br/>one vehicle to another, what the process of testing actually does is /excludes/ all other<br/>vehicles, or people. They can say that they can exclude 6 billion other people from a DNA<br/>testing, isolating this one person."<br/>Moses says "They can't prove that it is /exactly/ that one person, but they can rule out,<br/>or exclude all the others."<br/>Moses says "So, similarly, in this case, we're not proving that they are doing new, delete,<br/>preview. We're excluding the case of 'clear'."<br/>Aleriel nodnods. "Nice analogy :)"<br/>Moses smiles. Thank you.<br/>Moses says "So, we've decided that our first test for the code has to be how many 'words'<br/>separated by '=' we have."<br/>Moses says "Now, can you think of another test that we need to do in our first switch?"<br/>Aleriel hmms. "if the switch is one of delete, preview, clear, etc.?"<br/>Moses expected you to guess that. And I'll also say that was somewhat of a trick question.<br/>The truth is, at this point, once we've isolated clear in our options, we can branch off<br/>into separate functions at this point.<br/>Moses says "So, for example: ex *armoire/cmd-wear1"<br/>Moses says "And yes, it's visual."<br/><br/>Armoire<br/>CMD-WEAR1:$+wear1/* *:@pemit <br/>%#=[switch(gt(words(%1,=),1),1,[setq(0,first(%1,=))][setq(1,rest(%1,=))][u(fn-notclear,%0,<br/>%q0,%q1)],[u(fn-clear,%1)],Boing. Code Error. Please report it to [name(owner(me))].)]<br/><br/>Moses says "What I did there was to separate my ufun's, based on the exclusion that I've made<br/>with the equals sign."<br/>Aleriel nods. "What if +wear/add was used, though?"<br/>Moses grins. Well, if you notice, I pass %0 as a parameter to fn-not clear<br/>Moses says "Whereas it's not passed to fn-clear."<br/>Moses says "Do the two setq()'s make sense?"<br/>Aleriel says "Yep. I'd just include the functions inside the u(), though, since %q0 and %q1<br/>are used only once there"<br/>Moses nods. True. I could have done it that way. This is indicative of 'my' coding style. I<br/>always try to set my variables before I use them. It's a holdover from doing things like<br/>Visual Basic and Pascal.<br/>Moses says "Okay, for an example of 'another' way to do this command, and an example of<br/>command-reliant coding style, ex armoire/cmd-wear2"<br/><br/>Armoire<br/>CMD-WEAR2:$+wear2/* *:@switch <br/>gt(words(%1,=),1)=1,{@switch %0[setq(0,first(%1,=))][setq(1,rest(%1,=))]=new-*,{@tr <br/>me/do-new=%#,[after(%0,-)],%q0,%q1},del*,{@tr me/do-delete=%#,%q0,%q1},put*,{@tr <br/>me/do-wear=%#,%q0,%q1},{@pemit %#=I'm sorry. That isn't a valid command.}},0,{@switch <br/>%0=clear,{@tr me/do-clear=%#,%1},{@pemit %#=I'm sorry. That isn't a valid command.}},{@pemit <br/>%#=Boing. Code Error. Please report it to [name(owner(me))].}<br/><br/>Aleriel nods<br/>Moses says "For this one, I didn't condense all the non-clear options into one branch, and<br/>clear into another."<br/>Moses says "Just to be different."<br/>Aleriel hrms. "So, +wear/add gets ruled out?"<br/>Hercules enters the room through the double doors, which swing closed behind him.<br/>Hercules has arrived.<br/>Hercules says "Sorry for coming in late. Is it alright if I just observe?"<br/>Moses says "Well, In this case, I named it +wear/new"<br/>Moses nods to Hercules, greeting him.<br/>Moses says "Sure. You've missed some, but that's okay."<br/>Aleriel ohs. "Ok"<br/>Moses says "If you want to see the code we were just looking at, ex armoire/cmd-wear1 and<br/>armoire/cmd-wear2"<br/>Aleriel waves to Hercules<br/>Hercules will catch up with those wonderful logs once they're posted.:)<br/>Moses grins. :)<br/>Moses says "Aleriel, I named it new because I was wanting to diffrentiate between putting it<br/>into your desc(conceivably seen as 'adding' it) and making an entirely new description."<br/>Aleriel nods. "Makes sense"<br/>Moses whews, and goes on. :)<br/>Aleriel grins<br/>Moses says "Since clear is just one case, we'll look at it first. ex armoire/fn-clear"<br/><br/>Armoire<br/>FN-CLEAR:[switch(u(fn-typeok,%0),0,[v(msg-bad-type)] to clear.,[set(me,current-%0:)]Your <br/>[lcstr(%0)] has been cleared.)]<br/><br/>Moses says "And in order to understand that, you should look at fn-typeok and msg-bad-type"<br/><br/>Armoire<br/>FN-TYPEOK:[member(base clothes,lcstr(%0))]<br/>MSG-BAD-TYPE:I'm sorry. You must specify either base or clothes<br/><br/>Aleriel nods<br/>Moses says "Okay, this is a coding practice of re-using code. While there are some assumptions<br/>I can make about user input, I still have to test for errors. Typoes happen, even to the best<br/>of us. *ahem*. ;)"<br/>Moses says "For each of the options, the user is required to specify whether they are<br/>referencing a base or clothes section of their desc."<br/>Moses says "So, we need to make sure that they are /only/ referencing either base or clothes.<br/>Else, they might get a number of things listed as 'set' or 'deleted', when in truth, the code<br/>just took what it gave them, and went with it."<br/>Moses says "This prevents them from accidentally adding a clohtes-my~best~desc~ever attribute<br/>to their object, and then never being able to put it on, because the word 'clothes' was<br/>misspelled."<br/>Moses says "So, fn-typeok checks to see if the type they are referencing is either base or<br/>clothes. And member() returns a 0 if the test data is not in the specified list, so we can<br/>test for 0 with a switch in order to rule out errors."<br/>Moses says "And since I knew I was going to have to make this test for everything, I chose<br/>to put it in a ufun."<br/>Moses says "Another option would have been to test for it after or with our initial test<br/>with the '='."<br/>Moses says "But, I didn't think it was necessary."<br/>Moses says "Oh, that reminds me of something."<br/>Moses says "We are currently sitting on a TinyMUSH generation 2.2. That means that some<br/>of the code here is deprecated compared to the code we may be using on our PennMUSH 1.7.3<br/>or TinyMUSH 3.0 Mushes that we normally code on."<br/>Moses says "We know that member() is going to, in this case, return either 0 1 or 2 as a<br/>value."<br/>Moses says "We could, on a more current mush, set our switch to test for the &gt;0 case."<br/>Moses says "As in switch(u(fn-typeok,%0),&gt;0,blahblah,Boing. Error.)"<br/>Moses says "I tried to do that here, and it didn't work."<br/>Moses says "So, I did it the other way."<br/>Moses says "That was your lesson on differing ages of codebases."<br/>Moses says "And, so that I can be pedantic, I'll explain that the msg-bad-type is a<br/>default message that I can show for each type of command saying that they need to specify<br/>base or clothes &lt;to clear, to delete, to preview, etc.&gt;"<br/>Aleriel often codes a small functions for 'smart' matches.. ex whee/fn_wise_match<br/>Moses says "Example?"<br/>Aleriel says "it returns either 0 or 1"<br/>Aleriel dropped Whee.<br/><br/>Aleriel's Whee<br/>FN_WISE_MATCH:[not(not(match(%0,%1,%2)))]<br/><br/>Aleriel says "ex #1354/fn_wise_match"<br/>Moses nods.<br/>Moses says "Okay. That's a way to do it. I have a personal preference against 'negative'<br/>coding. I usually test /for/ a value, rather than it's 'not' value."<br/>Moses says "Again, personal preferences."<br/>Aleriel nods<br/>Moses says "There are some cases where you have to use not. hasflag() and orflags() being<br/>good examples."<br/><br/>[Post-class Note: I said these as examples on the spur of the moment, but upon reflection,<br/>these don't even prove true. It's just as easy to test for hasflag(%#,Wizard) = 0 as it is<br/>to test for not(hasflag(%#,Wizard)) = 1. A good example of when to use not(), imho, is this:<br/>You want to lock something against someone with a specific name. So you can do:<br/><br/>@lock exit=isname/1<br/>&amp;isname exit=[not(match(Name,%N))]<br/><br/>This code would always return 0 or 1, since match() returns the first occurrence of the test<br/>data in the string. So, either it's their name or it's not, 0 or 1. If it is their name, the<br/>not() reverses the value, and they would be prevented from using the exit.<br/><br/>However, you can do @lock exit=isname/0 and not use the not() function. However, standard<br/>practice is to lock to a value of 1.<br/><br/>Personal preference. Whatever works best for you, and still works.]<br/><br/>Moses says "Okay, back to fn-clear. Once we've cleared that we're using the right kind of<br/>type, we 'clear' the attribute pointing to which description we were using, and return a<br/>message stating that we did such."<br/>Moses notes that there is one school of coding thought out there that thinks no output is<br/>good output. If you don't get something back, it must have worked. I don't agree with this,<br/>because succeeding silently and failing silently wind up having the same effect.<br/>Moses says "As an example of doing this with commands rather than side-effect functions, you<br/>can check out armoire/do-clear"<br/><br/>Armoire<br/>DO-CLEAR:@switch u(fn-typeok,%1)=0,{@pemit %0=[v(msg-bad-type)] to clear.},{&amp;current-%1<br/>me=;@pemit %0=Your '%1' has been cleared.}<br/><br/>Moses supposes you'd love for me to explain why I chose to name the attribute 'current-base'<br/>and 'current-clothes'<br/>Moses says "Go on, ask me. :)"<br/>Moses says "Since you asked, I named them that way to make them stand out from the<br/>attributes named base-blah and clothes-blah."<br/>Aleriel says "Makes sense"<br/>Moses nods. We'll get to the paradigm of displaying the desc in a bit.<br/>Moses says "Okay, the other side of the coin was fn-notclear"<br/><br/>Armoire<br/>FN-NOTCLEAR:[switch(lcstr(%0),new*,[u(fn-new,[after(%0,-)],%1,%2)],del*,[u(fn-del,%1,%2)],<br/>put*,[u(fn-puton,%1,%2)],prev*,[u(fn-preview,%1,%2)],I'm sorry. That isn't a valid command.)]<br/><br/>Moses says "This is the big 'parser' function that delegates the work to the smaller<br/>functions for each type of job."<br/>Moses says "And, as the default at the end of the switch, I made the code robust enough<br/>to take the option that someone types in a bum command."<br/>Moses is just dying for you to jump in and say something. :)<br/>Aleriel says "Umm.. :)"<br/>Moses says "WOuld you have done it differently, for instance? If so, why? Let's talk."<br/>Moses is all for interactivity.<br/>Aleriel grins<br/>Hercules missed the class on setq and such, so will need to bone up on that first, and then<br/>go through the log for this class, but so far, this is all actually making sense, for which<br/>I thank you.<br/>Aleriel shakes her head, "No, I don't think I'd do anything differently.. your approach<br/>makes sense"<br/>Moses woo's. :)<br/>Moses grins at Hercules.<br/>Moses says "Herc, for a short definition: setq() sets a variable that exists only so long as<br/>the specific command is running. And as setq() it doesn't insert itself into the output, it<br/>just puts it into memory. setr() will do the same thing, /and/ insert itself into the output."<br/>Moses says "If you would like to examine the functions fn-del and fn-preview, you'll notice a<br/>lot of similarities between them."<br/><br/>Armoire<br/>FN-DEL:[switch(u(fn-typeok,%0),0,[v(msg-bad-type)]%bto <br/>delete.,[switch(setr(0,lattr(me/%0-[u(fn-space2tilde,%1)])),,[u(msg-no-attr,%0,%1)],<br/>[wipe(me/%q0)]Your '%0' named '%1' has been deleted.)])]<br/>FN-PREVIEW:[switch(u(fn-typeok,%0),0,[v(msg-bad-type)] to <br/>preview.,[switch(lattr(me/%0-[setr(0,u(fn-space2tilde,%1))]),,[u(msg-no-attr,%0,%1)],Your '%0' <br/>named '%1' appears as:%R[v(%0-%q1)])])]<br/><br/>Aleriel nods<br/>Moses says "Herc, you'll see in these examples, that I used setr(), because I wanted to<br/>'save' the value, and I wanted it to show up at that point in the code."<br/>Moses says "msg-no-attr just says: I don't see a %0 named %1."<br/>Moses says "Once again, I tested for an ok type, checked for 0, threw an error msg out, and<br/>went on with the code."<br/>Moses says "Now, I knew there was another error I had to test for."<br/>Moses says "What if the user was trying to delete or preview an attribute that didn't exist?"<br/>Moses says "So, what I did here was one of two standard ways to do it."<br/>Moses says "In this case, I used the lattr() function, to see if I could list the attribute<br/>that the user was looking to interact with."<br/>Moses says "If I couldn't, signified by empty response, I threw another error, telling them:<br/>I can't find that %0 named %1."<br/>Moses says "Which in this case would be: I can't find a base named bubba's jeans."<br/>Moses ahems. Hypothethically speaking, of course.<br/>Aleriel says "why not do a hasattr()?"<br/>Hercules nods.<br/>Moses points to Aleriel and makes dingding noises.<br/>Moses says "As a contrary example: ex armoire/do-delete"<br/>Aleriel nods..<br/>Moses says "On that one, I used hasattr() to test to see if the attribute existed. If it<br/>didn't, signified by a 0, I threw the error message."<br/>Aleriel says "so, why not use it in those two ufuns?"<br/>Moses says "Two reasons."<br/>Moses says "One, I'm trying to display many different ways to achieve the same effect."<br/>Moses says "Two, I wanted to display, as a coding practice, that testing for nothing is as<br/>valid as testing for something. Which is not the same as the negative coding I talked<br/>about before. In numerous coding instances, the absence of something is as significant as<br/>the presence of it."<br/>Aleriel nods<br/>Moses says "Okay, so last but not least, we have the option of adding a new description."<br/>Moses is going to make the assumption that the code presented in fn-del and fn-preview is<br/>pretty straightforward?<br/>Aleriel says "looks ok to me"<br/>Moses notes there is a do-preview as well, demonstrating that from the command-reliant point<br/>of view, rather than using ufuns and function calls.<br/>Moses says "Whoops."<br/>Moses says "There's supposed to be. :)"<br/>Moses says "Note to Class Log: Moses is a bonehead that forgot to code a do-preview."<br/>Aleriel makes a lame joke. "Ooh, a Minbari!" ;)<br/>Moses almost gets that.<br/>Aleriel says "Note to Class Log: Minbari are a race from Babylon 5.. they don't have hair,<br/>but have a bone crest around their heads."<br/>Moses ahhs. Okay. :)<br/>Moses never got started on B5, though has been told by numerous that he should have.<br/>Aleriel says "yes, you should've"<br/>Moses says "However, in this case, my exclusion of preview from the command-reliant section<br/>is a perfect thing for the next class.(Note for Herc: Tonight is just code-building. Next<br/>class is bug-chasing, streamlining, and documenting)"<br/>Moses says "Okay, so that brings us to the case of adding a new description."<br/>Moses says "With that basic command structure of +wear/* *, what do we do if we want to add<br/>a new base description?"<br/>Aleriel ponders. "I suppose we'd have something like '+wear/add type/name=desc'?"<br/>Moses nods. That was the first option that I thought about.<br/>Aleriel says "then I guess we'll have to separate type and name, check whether the type is<br/>valid, whether the name already exists, and, if all checks are passed, set the attribute?"<br/>Moses nods. Bingo.<br/>Moses says "Which is what I did, except I chose to do it +wear/new-base &lt;name&gt;=&lt;text&gt;"<br/>Moses says "The reason I did this was to keep the left hand side of the command, specifically<br/>%0 being the 'router' and the right side being the raw data."<br/>Aleriel nods<br/>Moses says "Now, If +wear/new type/name=text was in place, that would still be true, but<br/>it's a matter of organization, or put more bluntly, it's less confusing for me to keep track<br/>of."<br/>Moses says "In my head, in my 'concept' for the structure of this code, %0 tells me which<br/>ufun to call. Whether it's a new-base or a new-clothes, I'm still calling fn-new, but...I<br/>can pass the important part of %0 in, as well."<br/>Aleriel nods. "Your way would probably be easier, yes, cause otherwise we'd have to check<br/>all data for /, even with other switches"<br/>Moses nods. Right. that was what I was just typing, actually. :)<br/>Aleriel grins and bows :)<br/>Moses says "So, if you look at armoire/fn-notclear again, you'll see that in the call to<br/>fn-new, I pass after(%0,-), %1, and %2"<br/>Aleriel nods<br/>Moses says "In this case, I extracted the relevant part of the %0 before I called the<br/>function. Just for variety."<br/>Moses says "Before, I did the setq() to set a piece of %1, before it got passed, and<br/>Aleriel suggested just doing the extraction in the function call."<br/>Moses says "here, I did that, just to show the other way."<br/>Aleriel hrms. "What if there is no '-' in the switch, though?"<br/>Aleriel says "I mean, what if the user made a typo or mistake or whatever?""<br/>Moses grins. ex armoire/fn-new<br/><br/>Armoire<br/>FN-NEW:[switch(u(fn-typeok,%0),0,[v(msg-bad-type)]%bfor a new description <br/>element.,{[set(me,%0-[u(fn-space2tilde,%1)]:%2)]Your new %0 description, named '%1' is set <br/>as:%R[s(%2)]})]<br/><br/>Moses says "The part after the - is going to be either base or clothes."<br/>Moses says "So, if they typo that, fn-typeok is going to catch it."<br/>Aleriel notices that 'after(blah,-)' doesn't return anything at all. Not even an error<br/>Moses says "Right. It won't, until fn-typeok."<br/>Moses says "The user is supposed to type in: +wear/new-base or +wear/new-clothes"<br/>Moses says "We are taking after(%0,-), which should ideally return either base or clothes."<br/>Moses says "Whatever value the after() returns is %0 in fn-new. And the first thing fn-new<br/>does is test %0 against fn-typeok."<br/>Moses says "So, there is the error catching for that."<br/>Aleriel hrms. "Oh. I see now. I'm having a bit of a blonde moment here.. Nevermind me :)"<br/>Moses grins. NP.<br/>Moses says "It's good for the log that I explained that."<br/>Aleriel says "Clarification for the log: My hair is actually brown. :P"<br/>Moses laughs!<br/>Moses ahems.<br/>Moses says "Okay, for the next part of fn-new, what I did was use the set() side-effect<br/>function to set the attribute on the object, since we knew that it was either base or<br/>clothes. I used the space2tilde function to accomodate for multiple word titles for<br/>descriptions."<br/>Moses says "And, I returned a message telling the user that their description had been<br/>set, and showed them what the evaluated version of it looked like, using the s() function."<br/>Moses says "On tiny3.0 or Penn1.7.2 and above, I would have used eval() instead of s()."<br/>Aleriel says "Question: is there any difference between s() and eval()?"<br/>Moses says "However, this is Tiny2.2, and I had to use s(). Does the same thing."<br/>Moses shakes his head. Not really. No.<br/>Aleriel says "Ok"<br/>Hercules used to be blonde, but nature was good, and made his hair turn darker over the years.<br/>Moses says "About three letters you have to type? :)"<br/>Aleriel grins.<br/>Aleriel will be riiiiiiight back. Tea's needed.<br/>Moses grins at Hercules. Mine is dark brown, and receding. I just keep telling myself it's<br/>a sign of virility. :)<br/>Moses nodnods to Aleriel. We're almost done anyways.<br/>Moses says "Okay, the last thing I wanted to talk about tonight, and should fill up the<br/>twenty minutes until class is over, is /how/ do we display the descriptions we're setting?"<br/>Moses says "Again, there are two 'classic' methods of doing this. One method is to manually<br/>@desc the character each time a change in the +wear elements is made."<br/>Moses says "There is another way to do this, and it's one I prefer."<br/>Aleriel returns.<br/>Moses says "We designed this code to work with the attributes being stored on the object,<br/>rather than the character."<br/>Moses says "It's easier for the object to read the attributes off of itself than for the<br/>character to read them off of the object."<br/>Aleriel says "you want to @parent the character to the object so that the desc is inherited?"<br/>Moses shakes. :)<br/>Aleriel says "Okay.. you could also put a permanent @desc on the character that would just<br/>read attributes from the object"<br/>Moses says "What I intend to do is have the player's @desc be reset once, pointing with a<br/>u() call to a static attribute on the object that reads what the current settings for base<br/>and clothes are."<br/>Moses jinxes Aleriel.<br/>Moses says "That's /exactly/ what I want to do. ex armoire/player-desc"<br/><br/>Armoire<br/>PLAYER-DESC:[u(base-[u(current-base)])]%b[u(clothes-[u(current-clothes)])]<br/><br/>Aleriel nodnods<br/>Moses says "And, at the next class, we will code a +wear/setup * command that will look at<br/>the object number for our +wear object, and @desc the character with [u(obj/player-desc)]"<br/>Moses says "It will also save their previous desc, just in case."<br/>Aleriel hrms. "Should we create a new object for each player, or this code isn't intended to<br/>be used by several people?"<br/>Moses says "Okay, here is where I admit that I patterned this one small part after a<br/>globally-designed system."<br/>Moses says "However, it is the most efficient way to use the attributes that are stored on<br/>a separate object, rather than the character."<br/>Moses says "imho."<br/>Moses says "Ideally, there would be a global code object, and each person would have their<br/>+wear object for storage only."<br/>Aleriel nods<br/>Moses says "It would have the player-desc and current-base, current-clothes attributes on it,<br/>but all of the code would be global."<br/>Moses says "Another way to implement this is to just have a parent'able code object. Doesn't<br/>have to be global code. If you parent a dummy object to the code object, you'd have the<br/>same effect."<br/>Aleriel says "in that case, we'll need to set the local object's dbref on the player, and<br/>modify all ufuns to work with it.."<br/>Moses nods. Yes, we would.<br/>Moses says "here is where I say: http://mushkode.steelemountain.com/penn/wear.txt"<br/>Aleriel nods<br/>Moses says "What that is is a global +wear system I did for a PennMUSH that uses precisely<br/>this system. There is the argument that it is an inefficient use of Master Room resources to<br/>have code that does that many lookups on a player and a player's object, but I think that is<br/>dependent on the size of the mush and the stability of the server."<br/>Aleriel says "well, imho, the global descer commands aren't used /that/ much at the same time,<br/>so it should be ok"<br/>Moses says "This system is being used on three mushes(where coincidentally I codewiz, go<br/>figure), and there have been no problems."<br/>Moses nods. Precisely.<br/>Moses says "The +wear is used maybe once a day by a character, whereas your globals object,<br/>with your +finger, +where, etc...that one is pummeled with usage."<br/>Hercules is going to excuse himself and head to bed. It's been a long day. Thank-you very<br/>much, Moses. I really do appreciate these classes and the time you all take for giving them.<br/>Moses smiles and nods. "It's my pleasure."<br/>Moses says "Make sure to read the log to catch the first half hour of the class, Herc."<br/>Aleriel waves to Herc, "G'Night"<br/>Hercules says "Will do. Good night to all of you."<br/>Moses says "G'night."<br/>Moses says "Any final questions, Aleriel?"<br/>Moses says "Note for Class Log: I am going to leave the Armoire in this room so that any<br/>can come and look at it that would like to."<br/>Aleriel thinks. "Nope, not really"<br/>Moses nods and closes the log then.<br/><br/>
    </div>
</div>
<script type="text/javascript">
    var selectText = function(element) {
        var doc = document;
        var text = doc.getElementById(element);

        if (doc.body.createTextRange) { // ms
            var range = doc.body.createTextRange();
            range.moveToElementText(text);
            range.select();
        } else if (window.getSelection) { // moz, opera, webkit
            var selection = window.getSelection();
            var range = doc.createRange();
            range.selectNodeContents(text);
            selection.removeAllRanges();
            selection.addRange(range);
        }
    }

    $('a.select-all').click(function () {
        selectText('code');
    });
</script>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</body>

</html>
<script src="../Scripts/Google.js" type="text/javascript"></script>