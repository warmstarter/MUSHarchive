<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Code: Brandy Mail 1.4 +filter patch</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <!-- Apple devices fullscreen -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <!-- Apple devices fullscreen -->
    <meta names="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <!-- Bootstrap -->
	<link rel="stylesheet" href="../Theme/Flat/html/css/bootstrap.min.css">
	<!-- Bootstrap responsive -->
	<link rel="stylesheet" href="../Theme/Flat/html/css/bootstrap-responsive.min.css">
	<!-- jQuery UI -->
	<link rel="stylesheet" href="../Theme/Flat/html/css/plugins/jquery-ui/smoothness/jquery-ui.css">
	<link rel="stylesheet" href="../Theme/Flat/html/css/plugins/jquery-ui/smoothness/jquery.ui.theme.css">
	<!-- Theme CSS -->
	<link rel="stylesheet" href="../Theme/Flat/html/css/style.css">
	<!-- Color CSS -->
	<link rel="stylesheet" href="../Theme/Flat/html/css/themes.css">


    <link rel="stylesheet" href="../Content/site.css">

    <!-- jQuery -->
    <script src="../Theme/Flat/html/js/jquery.min.js"></script>
    <!-- Nice Scroll -->
    <script src="../Theme/Flat/html/js/plugins/nicescroll/jquery.nicescroll.min.js"></script>
    <!-- jQuery UI -->
    <script src="../Theme/Flat/html/js/plugins/jquery-ui/jquery.ui.core.min.js"></script>
    <script src="../Theme/Flat/html/js/plugins/jquery-ui/jquery.ui.widget.min.js"></script>
    <script src="../Theme/Flat/html/js/plugins/jquery-ui/jquery.ui.mouse.min.js"></script>
    <script src="../Theme/Flat/html/js/plugins/jquery-ui/jquery.ui.resizable.min.js"></script>
    <script src="../Theme/Flat/html/js/plugins/jquery-ui/jquery.ui.sortable.min.js"></script>
    <!-- slimScroll -->
    <script src="../Theme/Flat/html/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
    <!-- Bootstrap -->
    <script src="../Theme/Flat/html/js/bootstrap.min.js"></script>
    <!-- Form -->
    <script src="../Theme/Flat/html/js/plugins/form/jquery.form.min.js"></script>

    <!-- Theme framework -->
    <script src="../Theme/Flat/html/js/eakroko.min.js"></script>
    <!-- Theme scripts -->
    <script src="../Theme/Flat/html/js/application.min.js"></script>

    <!--[if lte IE 9]>
		<script src="js/plugins/placeholder/jquery.placeholder.min.js"></script>
		<script>
			$(document).ready(function() {
				$('input, textarea').placeholder();
			});
		</script>
	<![endif]-->

    <!-- Favicon -->
    <link rel="shortcut icon" href="http://www.mushcode.com/File/img/favicon.ico" />
    <!-- Apple devices Homescreen icon -->
    <link rel="apple-touch-icon-precomposed" href="http://www.mushcode.com/File/img/apple-touch-icon-precomposed.png" />

</head>

<body class="theme-green">
    <div id="navigation">
        <div class="container-fluid">
            <a href="../index.html" id="brand">MUSHCode.com</a>
        </div>
    </div>
    <div class="container-fluid" id="content">
        <div id="left">
            <div class="subnav">
                <div class="subnav-title">
                    <a href="Brandy-Mail-1-4-Plusfilter-patch.html#" class='toggle-subnav'>
                        <i class="icon-angle-down"></i>
                        <span>About</span>
                    </a>
                </div>
                <ul class="subnav-menu">
                    <li>
                        <a href="../index.html">Overview</a>
                    </li>
                </ul>
            </div>
            <div class="subnav">
                <div class="subnav-title">
                    <a href="Brandy-Mail-1-4-Plusfilter-patch.html#" class='toggle-subnav'>
                        <i class="icon-angle-down"></i>
                        <span>Files</span>
                    </a>
                </div>
                <ul class="subnav-menu">
                    <li class='dropdown'>
                        <a href="Brandy-Mail-1-4-Plusfilter-patch.html#" data-toggle="dropdown">Code</a>
                        
<ul class="dropdown-menu">
        <li>
            <a href="../Category/Administration.html">Administration</a>
        </li>
        <li>
            <a href="../Category/Building.html">Building</a>
        </li>
        <li>
            <a href="../Category/Bulletin-Board.html">Bulletin Board</a>
        </li>
        <li>
            <a href="../Category/Combat.html">Combat</a>
        </li>
        <li>
            <a href="../Category/Dynamic-Space.html">Dynamic Space</a>
        </li>
        <li>
            <a href="../Category/Fonts.html">Fonts</a>
        </li>
        <li>
            <a href="../Category/Functions.html">Functions</a>
        </li>
        <li>
            <a href="../Category/Games.html">Games</a>
        </li>
        <li>
            <a href="../Category/Globals.html">Globals</a>
        </li>
        <li>
            <a href="../Category/Mail-Systems.html">Mail Systems</a>
        </li>
        <li>
            <a href="../Category/Other.html">Other</a>
        </li>
        <li>
            <a href="../Category/Schedulers.html">Schedulers</a>
        </li>
        <li>
            <a href="../Category/Time.html">Time</a>
        </li>
        <li>
            <a href="../Category/Vehicles.html">Vehicles</a>
        </li>
        <li>
            <a href="../Category/Vendors.html">Vendors</a>
        </li>
        <li>
            <a href="../Category/Weather-Systems.html">Weather Systems</a>
        </li>
</ul>
                    </li>
                    <li class='dropdown'>
                        <a href="Brandy-Mail-1-4-Plusfilter-patch.html#" data-toggle="dropdown">Classes</a>
                        
<ul class="dropdown-menu">
        <li>
            <a href="../Category/Administration.html">Administration</a>
        </li>
        <li>
            <a href="../Category/Building.html">Building</a>
        </li>
        <li>
            <a href="../Category/Globals.html">Globals</a>
        </li>
        <li>
            <a href="../Category/Hardcode.html">Hardcode</a>
        </li>
        <li>
            <a href="../Category/Other.html">Other</a>
        </li>
        <li>
            <a href="../Category/Softcode.html">Softcode</a>
        </li>
</ul>
                    </li>
                    <li>
                        <a href="../Manuals.html">Manuals</a>
                    </li>
                </ul>
            </div>
            <div class="subnav">
                <div class="subnav-title">
                    <a href="Brandy-Mail-1-4-Plusfilter-patch.html#" class='toggle-subnav'>
                        <i class="icon-angle-down"></i>
                        <span>Misc</span>
                    </a>
                </div>
                <ul class="subnav-menu">
                    <li>
                        <a href="../Ascii2Mu.html">ASCII To MUSHCode</a>
                    </li>
                    <li>
                        <a href="../MushList.html">MUSH/MUX List</a>
                    </li>
                    <li>
                        <a href="../MushRoom.html">MUSHRoom</a>
                    </li>
                </ul>
            </div>
            <div class="subnav">
                <div class="subnav-title">
                    <a href="Brandy-Mail-1-4-Plusfilter-patch.html#" class='toggle-subnav'>
                        <i class="icon-angle-down"></i>
                        <span>Contribute</span>
                    </a>
                </div>
                <ul class="subnav-menu">
                    <li>
                        <a href="../Submit.html">Submit</a>
                    </li>
                </ul>
            </div>
        </div>
        <div id="main">
            <div class="container-fluid">
                <div class="breadcrumbs">
                    <ul>
                        
    <li>
        <a href="../index.html">Home</a>
        <i class="icon-angle-right"></i>
    </li>
    <li>
        <a href="../Category/Mail-Systems.html">Mail Systems</a>
        <i class="icon-angle-right"></i>
    </li>
    <li>
        <a href="Brandy-Mail-1-4-Plusfilter-patch.html#">Brandy Mail 1.4 +filter patch</a>
    </li>

                    </ul>
                </div>
                <div class="row-fluid">
                    <div class="span12">
                        



<div class="box">
    <div class="box-title title">
        <h2>
            Brandy Mail 1.4 +filter patch
        </h2>
    </div>
    <div class="box-content">

        <div class="description">
            <p>The code adds a TO:&lt;player or mail alias&gt; filter. It filters out incoming messages with TO lines exactly matching the filter text. The code also introduces checking for existing filters.</p>
        </div>

        <div class="author">
            <strong>Author:</strong>
                <a href="../Author/Greg-Kempe.html">Greg Kempe</a>
        </div>

        <div class="author">
            <strong>Category:</strong>
            <a href="../Category/Mail-Systems.html">Mail Systems</a>
        </div>

            <div class="commands">
            <strong>Commands:</strong>
                    <a href="http://www.mushcode.com/Command/@create" class="command">@create</a>,
                    <a href="http://www.mushcode.com/Command/@dolist" class="command">@dolist</a>,
                    <a href="http://www.mushcode.com/Command/@drain" class="command">@drain</a>,
                    <a href="http://www.mushcode.com/Command/@edit" class="command">@edit</a>,
                    <a href="http://www.mushcode.com/Command/@pemit" class="command">@pemit</a>,
                    <a href="http://www.mushcode.com/Command/@set" class="command">@set</a>,
                    <a href="http://www.mushcode.com/Command/@startup" class="command">@startup</a>,
                    <a href="http://www.mushcode.com/Command/@teleport" class="command">@teleport</a>,
                    <a href="http://www.mushcode.com/Command/@trigger" class="command">@trigger</a>,
                    <a href="http://www.mushcode.com/Command/@wait" class="command">@wait</a>.
            </div>

            <div class="functions">
                <strong>Functions:</strong>
                        <a href="../Function/add.html" class="function">add&#40;&#41;</a>,
                        <a href="../Function/after.html" class="function">after&#40;&#41;</a>,
                        <a href="../Function/and.html" class="function">and&#40;&#41;</a>,
                        <a href="../Function/before.html" class="function">before&#40;&#41;</a>,
                        <a href="../Function/center.html" class="function">center&#40;&#41;</a>,
                        <a href="http://www.mushcode.com/Function/con" class="function">con&#40;&#41;</a>,
                        <a href="../Function/edit.html" class="function">edit&#40;&#41;</a>,
                        <a href="../Function/eq.html" class="function">eq&#40;&#41;</a>,
                        <a href="../Function/escape.html" class="function">escape&#40;&#41;</a>,
                        <a href="../Function/extract.html" class="function">extract&#40;&#41;</a>,
                        <a href="../Function/filter.html" class="function">filter&#40;&#41;</a>,
                        <a href="../Function/first.html" class="function">first&#40;&#41;</a>,
                        <a href="../Function/get.html" class="function">get&#40;&#41;</a>,
                        <a href="../Function/gt.html" class="function">gt&#40;&#41;</a>,
                        <a href="../Function/hasattr.html" class="function">hasattr&#40;&#41;</a>,
                        <a href="../Function/isdbref.html" class="function">isdbref&#40;&#41;</a>,
                        <a href="../Function/isnum.html" class="function">isnum&#40;&#41;</a>,
                        <a href="../Function/iter.html" class="function">iter&#40;&#41;</a>,
                        <a href="../Function/lcstr.html" class="function">lcstr&#40;&#41;</a>,
                        <a href="../Function/ldelete.html" class="function">ldelete&#40;&#41;</a>,
                        <a href="../Function/ljust.html" class="function">ljust&#40;&#41;</a>,
                        <a href="../Function/lnum.html" class="function">lnum&#40;&#41;</a>,
                        <a href="../Function/lt.html" class="function">lt&#40;&#41;</a>,
                        <a href="../Function/lte.html" class="function">lte&#40;&#41;</a>,
                        <a href="../Function/match.html" class="function">match&#40;&#41;</a>,
                        <a href="../Function/member.html" class="function">member&#40;&#41;</a>,
                        <a href="../Function/name.html" class="function">name&#40;&#41;</a>,
                        <a href="../Function/neq.html" class="function">neq&#40;&#41;</a>,
                        <a href="../Function/not.html" class="function">not&#40;&#41;</a>,
                        <a href="../Function/num.html" class="function">num&#40;&#41;</a>,
                        <a href="../Function/or.html" class="function">or&#40;&#41;</a>,
                        <a href="../Function/owner.html" class="function">owner&#40;&#41;</a>,
                        <a href="../Function/remove.html" class="function">remove&#40;&#41;</a>,
                        <a href="../Function/repeat.html" class="function">repeat&#40;&#41;</a>,
                        <a href="../Function/rjust.html" class="function">rjust&#40;&#41;</a>,
                        <a href="../Function/secure.html" class="function">secure&#40;&#41;</a>,
                        <a href="../Function/setq.html" class="function">setq&#40;&#41;</a>,
                        <a href="../Function/setunion.html" class="function">setunion&#40;&#41;</a>,
                        <a href="../Function/sign.html" class="function">sign&#40;&#41;</a>,
                        <a href="../Function/space.html" class="function">space&#40;&#41;</a>,
                        <a href="../Function/squish.html" class="function">squish&#40;&#41;</a>,
                        <a href="../Function/strlen.html" class="function">strlen&#40;&#41;</a>,
                        <a href="../Function/strmatch.html" class="function">strmatch&#40;&#41;</a>,
                        <a href="../Function/sub.html" class="function">sub&#40;&#41;</a>,
                        <a href="../Function/switch.html" class="function">switch&#40;&#41;</a>,
                        <a href="../Function/time.html" class="function">time&#40;&#41;</a>,
                        <a href="../Function/trim.html" class="function">trim&#40;&#41;</a>,
                        <a href="../Function/trunc.html" class="function">trunc&#40;&#41;</a>,
                        <a href="../Function/type.html" class="function">type&#40;&#41;</a>,
                        <a href="../Function/u.html" class="function">u&#40;&#41;</a>,
                        <a href="../Function/ulocal.html" class="function">ulocal&#40;&#41;</a>,
                        <a href="../Function/v.html" class="function">v&#40;&#41;</a>,
                        <a href="../Function/words.html" class="function">words&#40;&#41;</a>.
            </div>


            <div class="servers">
                <strong>Compatibility:</strong>
                        <a href="../Server/PennMUSH.html" class="server">PennMUSH</a>,
                        <a href="../Server/TinyBit.html" class="server">TinyBit</a>,
                        <a href="../Server/TinyMUSH.html" class="server">TinyMUSH</a>,
                        <a href="../Server/TinyMUX.html" class="server">TinyMUX</a>.
            </div>

    </div>
</div>

    <div class="box box-color green box-condensed box-bordered">
	    <div class="box-title">
            <h3>Instructions</h3>
        </div>
	    <div class="box-content">
		    Copy and paste the below code into a compatible MUSH or MUX.
	    </div>
    </div>

<div class="box box-bordered box-condensed">
    <div class="box-title">
        <h3>
	        <i class="icon-reorder"></i>
	        MUSHCode for Brandy Mail 1.4 +filter patch
        </h3>
        <div class="actions">
	        <a class="btn btn-mini select-all" href="Brandy-Mail-1-4-Plusfilter-patch.html#">
                    <i class="icon-resize-full"></i> Select Code
            </a>
        </div>
    </div>
    <div id="code" class="box-content content">
        #<br/># +filter Patch for BrandyMail 14<br/>#<br/># Version 1 (9/7/98)<br/># Patch coded by Greg Kempe (kempe@iafrica.com)<br/># BrandyMail coded by Brandy@CrystalMUSH<br/># Server: TinyMUSH 2.2.3, BrandyMail 14<br/>#<br/># HOWTO:<br/>#  o To apply the patch, change all occurrences of #17 to the dbref of your<br/>#    Parent Mail Object, all occurrences of #13 to the dbref of your Mail<br/>#    System object, and all occurrences of #22 to the dbref of your help<br/>#    object.<br/>#<br/>#  o Run the patch through Andrew Molitor's MUSH unformatter and then quote<br/>#    it to your MUSH.<br/>#<br/># NB: If you have added some other patches that affect the attributes listed<br/>#     below, I strongly advise against just overwriting them with these<br/>#     versions. The modified sections should, instead, be copied across<br/>#     manually (they are clearly marked by comments.)<br/>#     If you have installed my bug fixes there is no need to re-install them<br/>#     as this code contains those fixes too.<br/>#<br/># DISCLAIMER: I am not liable for any damages to your DB caused by this code.<br/>#             It shouldn't, though, do anything funny, so don't worry too much. <br/>#             This patch is in no way an official one for BrandyMail and is<br/>#             unsupported by Brandy.<br/>#             Please contact me with any oddities, so that I can update the<br/>#             patch code.<br/>#<br/># DESCRIPTION:<br/># The code adds a TO:&lt;player or mail alias&gt; filter.<br/># It filters out incoming messages with TO lines exactly matching the filter<br/># text.<br/># The code also introduces checking for existing filters.<br/># '+help mail filters' is updated accordingly.<br/>#<br/># Eg: +add filter to=medics folder=medical_foo<br/>#     +add filter to=jasper folder=important<br/>#<br/># Match examples:<br/>#<br/>#      filter                      message text                  works?<br/>#      ----------------------------------------------------------------<br/>#      Jasper                      Jasper                        yes<br/>#      Jasper                      Jasper, and Brandy            no<br/>#      medics (global mail alias)  medics (global mail alias)    yes<br/>#      medics (global mail alias)  medics (personal mail alias)  no<br/>#<br/>#<br/># Modified attributes:<br/>#   +add filter          : setting the filter and error checking (&amp;ADD_FILTER)<br/>#   +remove filter       : removal of the filter  (&amp;REMOVE_FILTER)<br/>#   +list filters        : displaying the filter  (&amp;LIST_FILTERS)<br/>#   &amp;GET_INFO_FOR_ONE_MAILBOX<br/>#                        : display pretty info for the filter<br/>#   &amp;OK_TO_DEST_MAILBOX  : checks if TO filters exist<br/>#   &amp;FOLDER_TO_STORE_INTO: the heart of the TO filter<br/>#   &amp;STORE_LETTER        : modified to pass the TO line to the above attrib<br/>#   &amp;DISPLAY_MAIL_ADMIN  : output on filter counts<br/>#   &amp;GET_FILTER_COUNT    : modified to tally TO filters too<br/>#   &amp;HELP_MAIL_FILTERS,<br/>#   &amp;HELP_MAIL_FILTERS2  : updated help information<br/>#<br/># New mailbox attribute:<br/>#     TO_FILTER          : text|folder~text|folder<br/>#<br/><br/><br/>&amp;ADD_FILTER #13=$+add filter *=* folder*=*: @swi/first [setq(0, get(%vm/mailbox_%#))][setq(1, edit(lcstr(trim(%3)), %b, $))][setq(4, switch(trim(%0),s*, subject,a*, author,t*, to,error))]1 = strmatch(%3, *reject*=*),,or(strmatch(escape(%0), *[*), strmatch(escape(%1), *[*), strmatch(escape(%3), *[*)), {@pemit %# = u(nofunc)},not(strmatch(type(%#), PLAYER)),{@pemit %# = u(not_player)},strmatch(%q4, error),{@pemit %# = You must specify the type of filter: author, subject or to.%b (syntax:%b +add filter author|subject|to=&lt;name, text or alias&gt; folder=&lt;folder name&gt;)},eq(words(%1), 0),{@pemit %# = You must specify [switch(%q4, author, A player name to filter on, to, A player name or mail alias to filter on, Some text to filter based on subject line)].%b (syntax:%b +add filter author|subject|to=&lt;name, text or alias&gt; folder=&lt;folder name&gt;)}, and(strmatch(%q4, author), not(strmatch(type(*%1), PLAYER))),{@pemit %# = Name specified to filter based on author is not an existing player.},and(strmatch(%q4, to),or(gt(words(%1),1),and(not(strmatch(type(*%1), PLAYER)),not(match(u(%vm/global-mail-aliases) [u(%q0/alias-list)], %1))))),{@pemit %# = Text to filter based on to: field must be a player name or mail alias.}, eq(words(%3), 0),{@pemit %# = You must specify a name for the folder.},gt(strlen([setq(2, [setq(3, %3)]filter(check_for_bad_chars, v(bad_chars)))]%q2), 0),{@pemit %# = Invalid character(s) %q2 detected in folder name.},gt(strlen(%3), 16),{@pemit %# = Folder name specified is too long (maximum of 16 characters).},[setq(5, [switch(%q4,author, [num(*%1)],to,u(pretty_dist,switch(isdbref(num(*%1)), 1,, %1),%q0,get(%q0/alias-list),u(%vm/global-mail-aliases),switch(isdbref(num(*%1)), 1, num(*%1))),%1)])]neq(match(get(%q0/%q4_filter), %q5|%q1, ~), 0),{@pemit %# = That filter already exists.},eq(strlen(%q0), 0),{@create %N's Mailbox; @set [setq(2, con(me))]%q2 = quiet; @drain %q2; &amp;debug_mail %q2 = +add filter %0=%1 folder%2=%3;  @tel %q2 = %vm; &amp;mailbox_%# %vm = %q2; @tr %vm/add_mailbox = %q2; &amp;owner_dbref %q2 = %#; @startup %q2 = {@drain me; @no me}; @set %q2 = safe; &amp;mail-in-progress %q2 = false; &amp;%q4_filter %q2 = %q5|%q1; &amp;current_folder %q2 = ulocal(get_inbox, %#); @pemit %# = Filter added.; @no %q2},{@wait %q0 = {&amp;debug_mail %q0 = +add filter %0=%1 folder%2=%3;  &amp;%q4_filter %q0 = trim([get(%q0/%q4_filter)]~%q5|%q1,,~); @pemit %# = Filter added.; @no %q0}}<br/>&amp;REMOVE_FILTER #13=$+remove filter*: @swi/first [setq(0, get(%vm/mailbox_%#))]1 = strmatch(escape(%0), *[*),{@pemit %# = u(nofunc)},eq(words(%0), 0), {@pemit %# = You must specify which filter to remove.},eq(strlen(%q0), 0), {@pemit %# = You have no filters defined.},or(not(strmatch(trunc(%0), trim(%0))),lt(%0, 1),not(isnum(%0))),{@pemit %# = You must enter a non-zero integer.%b See +list filters for a list of valid numbers.}, {@wait %q0 = {&amp;debug_mail %q0 = +remove filter%0;  @swi/first 1 = [setq(1, get(%q0/author_filter))][setq(2, get(%q0/subject_filter))][setq(3, get(%q0/to_filter))]gt(%0, add(words(%q1, ~), words(%q2, ~), words(%q3, ~))), {@pemit %# = Filter specified does not exist.; @no %q0},lte(%0, words(%q1, ~)), {&amp;author_filter %q0 = ldelete(%q1, %0, ~);@pemit %# = Author filter removed.;@no %q0},lte(%0, add(words(%q1, ~), words(%q2, ~))),{&amp;subject_filter %q0 = ldelete(%q2, sub(%0, words(%q1, ~)), ~); @pemit %# = Subject filter removed.; @no %q0}, {&amp;to_filter %q0 = ldelete(%q3, sub(%0, add(words(%q1, ~), words(%q2, ~))), ~);@pemit %# = To filter removed.;@no %q0}  }}<br/>&amp;LIST_FILTERS #13=$+list filters: @swi/first [setq(0, get(%vm/mailbox_%#))]strlen(%q0) = 0,{@pemit %# = You have no filters defined.},{@wait [setq(1, get(%q0/author_filter))][setq(2, get(%q0/subject_filter))][setq(3, u(get_format_option, get(%#/mail_config_options)))][setq(4, get(%q0/to_filter))]%q0 = {&amp;debug_mail %q0 = +list filters;  @pemit %# = switch(add(words(%q1, ~), words(%q2, ~), words(%q4, ~)), 0, You have no filters defined.,{[switch(%q3, standard, {[u(equal_line)]%r[center(List of Mail Filters, 78)]%r})][space(6)]Type[space(5)]Value[space(41)]Folder%r[u(dash_line)][iter(%q1, %r[rjust(member(%q1, ##, ~), 3)]\\)%b%bauthor%b%b%b[ljust(switch(type(before(##, |)), PLAYER, name(before(##, |)), destroyed player), 46)][secure(after(##, |))][switch(after(##, |), null, {%b\(discard\)},)],~)][iter(%q2, %r[rjust(add(words(%q1, ~), member(%q2, ##, ~)), 3)]\\)%b%bsubject%b%b[ljust(before(##, |), 46)][secure(after(##, |))][switch(after(##, |), null, {%b\(discard\)},)],~)][iter(iter(lnum(words(%q4, ~)), add(##, 1)),%r[rjust(add(words(%q1, ~), words(%q2, ~), ##), 3)]%)%b%bto[space(7)][setq(9,extract(%q4, ##, 1, ~))][ljust(before(edit(%q9, %%, ), |), 46)][secure(after(%q9, |))][switch(after(%q9, |), null, {%b\(discard\)},)])][switch(%q3, standard, {%r[u(equal_line)]})]}); @no %q0}}<br/>&amp;GET_INFO_FOR_ONE_MAILBOX #17 = [setq(0, get(%0/owner_dbref))][setq(1, get(%0/semaphore))][setq(2, get(%0/mail-in-progress))][setq(3, [switch(%q1, -1,, {[switch(strlen(%q1), 0,%bsem 0, %bsem%q1)]})])][ljust(%0, 7)][switch(hasattr(%0, autoforward), 0, %b%b, a%b)][switch(0, strmatch(owner(%0), owner(#15)), {%b-- WARNING -- This mailbox object is not owned by the right player!},strlen(%q2),{%b-- WARNING -- This does not seem to be a valid mailbox.},strmatch(type(%q0), PLAYER), {%b-- INFORMATIVE -- Mailbox for dest'ed player (do a +destroy mailbox for %q0.  Caution:%b all mail sent by that player will be removed from the destination mailboxes)},{[ljust(name(%q0), 17)][ljust(%q2%q3, 11)][rjust(add(words(get(%0/author_filter), ~), words(get(%0/subject_filter), ~),words(get(%0/to_filter), ~),), 7)][rjust(words(get(%0/alias-list)), 9)][rjust(words(remove(get(%0/folder-list), null)), 9)][rjust(words(get(%0/out-list)), 6)][rjust(words(u(get_all_in_lists, %0)), 10)]})]<br/>&amp;OK_TO_DEST_MAILBOX #17 =and(eq(words(u(get_all_in_lists, %0)), 0),eq(words(get(%0/out-list)), 0),strmatch(get(%0/mail-in-progress), false),get(%vm/delete_when_empty),lte(get(%0/semaphore), 0),not(hasattr(%0, alias-list)), not(hasattr(%0, author_filter)), not(hasattr(%0, subject_filter)), not(hasattr(%0, to_filter)),not(hasattr(%0, vacation)), not(hasattr(%0, reject_msg)), not(hasattr(%0, filter_reject)), not(hasattr(%0, autoforward)))<br/>&amp;FOLDER_TO_STORE_INTO #17=first([iter(get(%0/subject_filter), switch(strmatch(%2, *[before(##, |)]*), 1, after(##, |)), ~)] [iter(get(%0/author_filter), switch(strmatch(%1, [before(##, |)]), 1, after(##, |)), ~)] [iter(get(%0/to_filter), switch(strmatch(%4, before(##, |)), 1, after(##, |)), ~)] [ulocal(get_inbox, %3)])<br/>&amp;STORE_LETTER #17 = &amp;[setq(0, u(free_num, get(%0/out-list)))]out-%q0-time_sent %0 = time(); &amp;[setq(3, get(%0/owner_dbref))]out-%q0-subject %0 = %1; &amp;out-list %0 = [get(%0/out-list)] %q0; &amp;out-list-current %0 = switch(words(get(%0/out-list)), 1, %q0, get(%0/out-list-current)); &amp;out-%q0-to %0 = %2; &amp;out-%q0-cc %0 = %4; &amp;out-%q0-bcc %0 = %6; &amp;out-%q0-bcc-expanded %0 = %7; &amp;out-%q0-text %0 = %9[switch([setq(4, get(%q3/MAIL_SIG))]strlen(%q4), 0,, %r%q4)]; &amp;out-%q0-replyall_to %0 = setunion(%q3 %3 %5, ); &amp;out-%q0-held %0 = [setq(8, setunion(iter(setunion(%3 %5 %7, ), ulocal(autoforward_test, ##)), ))]%q8; &amp;out-%q0-dist %0 = iter(%q8, ##:); @dolist %q8 = {@swi/first [setq(1, get(%vm/mailbox_##))][setq(9, u(folder_to_store_into, %q1, get(%0/owner_dbref), %1, ##, %2))]1 = and(strmatch(type(##), PLAYER), eq(strlen(%q1), 0)),{@create [name(##)]'s Mailbox; @set [setq(2, con(me))]%q2 = quiet; @drain %q2; &amp;debug_mail %q2 = store_letter; @tel %q2 = %vm; &amp;mailbox_## %vm = %q2; @tr %vm/add_mailbox = %q2; &amp;owner_dbref %q2 = ##; @startup %q2 = {@drain me; @no me}; @set %q2 = safe; &amp;mail-in-progress %q2 = false; &amp;current_folder %q2 = %q9; &amp;folder-list %q2 = %q9; &amp;in-list-%q9 %q2 = 0; &amp;current_letter-%q9 %q2 = 0; &amp;in-0-time_read %q2 = 0; &amp;in-0-flags %q2 = %8; &amp;in-0-note %q2 = ; &amp;in-0-location %q2 = %0 %q0; @edit %0/out-%q0-dist = ##:,##:0; @pemit ## = switch(%1, Personal Note,, {u(delivery_notification, %q3, sign(match(%8, u)),sign(match(%8, p)),sign(match(%8, rr)),sign(match(%8, r)), secure(%q9))}); @no %q2}, strmatch(type(##), PLAYER), {&amp;folder-list %q1 = setunion(%q9 [get(%q1/folder-list)], ); &amp;in-list-%q9 %q1 = [setq(6, u(free_num, u(get_all_in_lists, %q1)))][setq(7, get(%q1/in-list-%q9))]squish(%q7 %q6); &amp;current_letter-%q9 %q1 = switch(words(%q7), 0, %q6, get(%q1/current_letter-%q9)); &amp;in-%q6-time_read %q1 = 0; &amp;in-%q6-flags %q1 = %8; &amp;in-%q6-note %q1 = ; &amp;in-%q6-location %q1 = %0 %q0; @edit %0/out-%q0-dist = ##:,##:%q6; @pemit ## = switch(1, strmatch(%1, Personal Note),, hasattr(%q1, reject_msg),, {u(delivery_notification, %q3, sign(match(%8, u)),sign(match(%8, p)),sign(match(%8, rr)),sign(match(%8, r)), secure(%q9))}); @swi/first 1 = strmatch(%1, On Vacation),,strmatch(%1, Letter Rejected),,and(strmatch(%q9, null), hasattr(%q1, filter_reject)),{@tr me/remove_letter =%0, %q0, get(%q1/owner_dbref), %q1, %q6, %q9, discard;@tr me/store_letter =%q1,Letter Rejected,name(get(%0/owner_dbref)),get(%0/owner_dbref),,,,,,{Message with subject line "%1" has been rejected by [name(get(%0/owner_dbref))]'s mailbox.%r%r----- Reject Message -----%r%r[get(%q1/filter_reject)]}; @pemit ## = Discarded due to personal mail filter.},strmatch(%q9, null),{@tr me/remove_letter = %0, %q0, get(%q1/owner_dbref), %q1, %q6, %q9,discard; @pemit ## = Discarded due to personal mail filter. },hasattr(%q1, reject_msg), {@tr me/remove_letter = %0, %q0, get(%q1/owner_dbref), %q1, %q6, %q9,reject; @tr me/store_letter = %q1, Letter Rejected, name(get(%0/owner_dbref)), get(%0/owner_dbref), ,  , ,  , , {Message with subject line "%1" has been rejected by [name(get(%q1/owner_dbref))]'s mailbox.%r%r----- Reject Message -----%r%r[get(%q1/reject_msg)]}},hasattr(%q1, vacation), {@tr me/store_letter = %q1, On Vacation, name(get(%0/owner_dbref)), get(%0/owner_dbref), ,  , ,  , , {Message with subject line "%1" has been stored in [name(get(%q1/owner_dbref))]'s mailbox.%r%r----- Vacation Message -----%r%r[get(%q1/vacation)]}}}, {@pemit get(%0/owner_dbref) = Unable to deliver message.} }<br/>&amp;DISPLAY_MAIL_ADMIN #17 = &amp;folder-list %1 = squish(remove(get(%1/folder-list), null)); @pemit %0 = [setq(0, u(get_format_option, get(%0/mail_config_options)))][setq(1, get(%1/owner_dbref))][setq(2, get(%1/mail-in-progress))][switch(%q0, standard, {[u(equal_line)]%rDetailed status for [name(%q1)]'s mailbox:%r[u(dash_line)]%r})][rjust(Mailbox dbref:, 20)]%b%b%1[switch(strlen(%q2), 0,{%r-- WARNING --  This does not seem to be a valid mailbox.})]%r[rjust(Mail-in-progress:, 20)]%b%b%q2%r[rjust(Received:, 20)]%b%b[words(u(get_all_in_lists, %1))]%r[rjust(Sent:, 20)]%b%b[words(get(%1/out-list))]%r[rjust(Personal aliases:, 20)]%b%b[words(get(%1/alias-list))] [switch(hasattr(%1, alias-list), 0,,([u(list_names, trim(get(%1/alias-list)))]))]%r[rjust(Filters:, 20)]%b%b[ulocal(get_filter_count, %q1)]%r[rjust(Folders:, 20)]%b%b[words(get(%1/folder-list))] [switch(hasattr(%1, folder-list), 0,,{([u(secure_names, trim(get(%1/folder-list)))])})]%r[rjust(Autoforward:, 20)]%b%b[ulocal(get_autoforward_option, %q1)]%r[rjust(Message Timeout:, 20)]%b%b[ulocal(get_timeout_option, %q1)]%r[rjust(Semaphore:, 20)]%b%b[get(%1/semaphore)]%r[rjust(Current Letter:, 20)]%b%b[get(%1/[u(which_current_letter, %1)])]%r[rjust(Current Folder:, 20)]%b%b[secure(get(%1/current_folder))]%r[rjust(Inbox:, 20)]%b%b[secure(ulocal(get_inbox, %q1))]%r[rjust(Vacation:, 20)]%b%b[u(%1/vacation)]%r[rjust(Reject:, 20)]%b%b[u(%1/reject_msg)]%r[rjust(Filter reject:, 20)]%b%b[u(%1/filter_reject)][switch(%q0, standard, {%r[u(equal_line)]})]; <br/>&amp;GET_FILTER_COUNT #17 = switch([setq(1, get(%vm/mailbox_%0))]0, strlen(%q1), 0, add(words(get(%q1/author_filter), ~), words(get(%q1/subject_filter), ~),words(get(%q1/to_filter), ~)))<br/>&amp;help_mail_filters #22=%(Page 1 of 2%)%r%rFilters can be used to automatically sort incoming mail into different folders (or automatically delete it if directed to the 'null' folder) based on author, partial match on subject, or exact match on To: header.%r%r%b%b%b%b+add filter author|subject|to=&lt;name, text or alias&gt; folder=&lt;folder name&gt;%r%b%b%b%b+remove filter &lt;number&gt;%r%b%b%b%b+list filters%r%rExamples:%r%r%b%b+add filter author=Brandy folder=null%r%r[space(4)]All incoming mail from Brandy will be automatically deleted. ;)%r%r%b%b+add filter subject=interview folder=interviews%r%r[space(4)]All incoming mail that has the word 'interview' in its subject line will%r[space(4)]be stored in folder 'interviews'.%r%r%b%b+add filter to=applications folder=apps%r%r[space(4)]All incoming mail addressed to the mail alias 'applications' will be%r[space(4)]stored in folder 'apps'%r%rSee also:%b mail filters2, mail folders<br/>&amp;help_mail_filters2 #22=%(Page 2 of 2%)%r%rExtra information for the 'to' filter:%r%rThe filter matches the To: header of a received +mail and is only really applicable to mail aliases. Note that the match must be an exact match.%r%rExamples:%r%rFilter Text[space(24)]To: Header Text[space(21)]Filter?%r[repeat(-,78)]%r[ljust(Jasper, 35)][ljust(Jasper, 36)]Yes%r[ljust(Jasper, 35)][ljust(Jasper and Brandy, 36)]No%r[ljust(medics %(global mail alias%),35)][ljust(medics %(global mail alias%), 36)]Yes%r[ljust(medics %(global mail alias%), 35)][ljust(medics %(global mail alias%) and Jai, 36)]No%r%rThis new filter was coded by Greg Kempe, aka Jasper@TowerMUSH (kempe@iafrica.com)<br/><br/>
    </div>
</div>
<script type="text/javascript">
    var selectText = function(element) {
        var doc = document;
        var text = doc.getElementById(element);

        if (doc.body.createTextRange) { // ms
            var range = doc.body.createTextRange();
            range.moveToElementText(text);
            range.select();
        } else if (window.getSelection) { // moz, opera, webkit
            var selection = window.getSelection();
            var range = doc.createRange();
            range.selectNodeContents(text);
            selection.removeAllRanges();
            selection.addRange(range);
        }
    }

    $('a.select-all').click(function () {
        selectText('code');
    });
</script>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</body>

</html>
<script src="../Scripts/Google.js" type="text/javascript"></script>